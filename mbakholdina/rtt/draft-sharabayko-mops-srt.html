<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The SRT Protocol</title>
<meta content="Maxim Sharabayko" name="author">
<meta content="Maria Sharabayko" name="author">
<meta content="Jean Dube" name="author">
<meta content="Jeongseok Kim" name="author">
<meta content="Joonwoong Kim" name="author">
<meta content="
       This document specifies Secure Reliable Transport (SRT) protocol. 
SRT is a user-level protocol over User Datagram Protocol and provides 
reliability and security optimized for low latency live video streaming, 
as well as generic bulk data transfer. For this, SRT introduces control
packet extension, improved flow control, enhanced congestion control
and a mechanism for data encryption. 
    " name="description">
<meta content="xml2rfc 2.47.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-sharabayko-mops-srt-00" name="ietf.draft">
<link href="draft-sharabayko-mops-srt.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@import url('https://martinthomson.github.io/i-d-template/fonts.css');

html {
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --small-font-size: 14.5px;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
#title {
  padding: 1em 0 0.2em;
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1, h2, h3 {
  font-size: 22px;
  line-height: 26px;
}
h4, h5, h6 {
  font-size: 18px;
  line-height: 22px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p, #abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 18px;
  line-height: 24px;
}
p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
dd.break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px 'Oxygen Mono', monospace;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre {
    display: inline-block;
    overflow-x: auto;
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
  table {
    display: inline-block;
    overflow-x: auto;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  margin: 0;
  padding: 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  visibility: hidden;
  user-select: none;
}
a.pilcrow[href] { color: #ddd; }
a.pilcrow[href]:hover { text-decoration: none; }
@media screen {
  :hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 500px) {
  .index ul {
    column-count: 2;
    column-gap: 20px;
  }
  .index ul ul {
    column-count: 1;
    column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left, table .text-left {
  text-align: left;
}
table .text-center, table .text-center {
  text-align: center;
}
table .text-right, table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SRT</td>
<td class="right">September 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Sharabayko, et al.</td>
<td class="center">Expires 6 March 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">MOPS</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-sharabayko-mops-srt-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-09-02" class="published">2 September 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-03-06">6 March 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M.P. Sharabayko</div>
<div class="org">Haivision Network Video, GmbH</div>
</div>
<div class="author">
      <div class="author-name">M.A. Sharabayko</div>
<div class="org">Haivision Network Video, GmbH</div>
</div>
<div class="author">
      <div class="author-name">J. Dube</div>
<div class="org">Haivision</div>
</div>
<div class="author">
      <div class="author-name">JS. Kim</div>
<div class="org">SK Telecom Co., Ltd.</div>
</div>
<div class="author">
      <div class="author-name">JW. Kim</div>
<div class="org">SK Telecom Co., Ltd.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The SRT Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies Secure Reliable Transport (SRT) protocol. 
SRT is a user-level protocol over User Datagram Protocol and provides 
reliability and security optimized for low latency live video streaming, 
as well as generic bulk data transfer. For this, SRT introduces control
packet extension, improved flow control, enhanced congestion control
and a mechanism for data encryption.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-note-to-readers">
<a href="#name-note-to-readers" class="section-name selfRef">Note to Readers</a>
      </h2>
<p id="section-note.1-1">Source for this draft and an issue tracker can be found at
  <a href="https://github.com/haivision/srt-rfc">https://github.com/haivision/srt-rfc</a>.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 6 March 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-motivation" class="xref">Motivation</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-secure-reliable-transport-p" class="xref">Secure Reliable Transport Protocol</a><a href="#section-toc.1-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terms-and-definitions" class="xref">Terms and Definitions</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-packet-structure" class="xref">Packet Structure</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-data-packets" class="xref">Data Packets</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-control-packets" class="xref">Control Packets</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-handshake" class="xref">Handshake</a><a href="#section-toc.1-1.3.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="xref">3.2.2</a>.  <a href="#name-keep-alive" class="xref">Keep-Alive</a><a href="#section-toc.1-1.3.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="xref">3.2.3</a>.  <a href="#name-ack-acknowledgment" class="xref">ACK (Acknowledgment)</a><a href="#section-toc.1-1.3.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.2.2.4">
                    <p id="section-toc.1-1.3.2.2.2.4.1"><a href="#section-3.2.4" class="xref">3.2.4</a>.  <a href="#name-nak-loss-report" class="xref">NAK (Loss Report)</a><a href="#section-toc.1-1.3.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.2.2.5">
                    <p id="section-toc.1-1.3.2.2.2.5.1"><a href="#section-3.2.5" class="xref">3.2.5</a>.  <a href="#name-shutdown" class="xref">Shutdown</a><a href="#section-toc.1-1.3.2.2.2.5.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.3.2.2.2.6">
                    <p id="section-toc.1-1.3.2.2.2.6.1"><a href="#section-3.2.6" class="xref">3.2.6</a>.  <a href="#name-ackack" class="xref">ACKACK</a><a href="#section-toc.1-1.3.2.2.2.6.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-srt-data-transmission-and-c" class="xref">SRT Data Transmission and Control</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-stream-multiplexing" class="xref">Stream Multiplexing</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-data-transmission-modes" class="xref">Data Transmission Modes</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-message-mode" class="xref">Message Mode</a><a href="#section-toc.1-1.4.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-live-mode" class="xref">Live Mode</a><a href="#section-toc.1-1.4.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="xref">4.2.3</a>.  <a href="#name-buffer-mode" class="xref">Buffer Mode</a><a href="#section-toc.1-1.4.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-handshake-messages" class="xref">Handshake Messages</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.  <a href="#name-caller-listener-handshake" class="xref">Caller-Listener Handshake</a><a href="#section-toc.1-1.4.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="xref">4.3.2</a>.  <a href="#name-rendezvous-handshake" class="xref">Rendezvous Handshake</a><a href="#section-toc.1-1.4.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-srt-buffer-latency" class="xref">SRT Buffer Latency</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-timestamp-based-packet-deli" class="xref">Timestamp Based Packet Delivery</a><a href="#section-toc.1-1.4.2.5.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a href="#section-4.5.1" class="xref">4.5.1</a>.  <a href="#name-packet-delivery-time" class="xref">Packet Delivery Time</a><a href="#section-toc.1-1.4.2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-too-late-packet-drop" class="xref">Too-Late Packet Drop</a><a href="#section-toc.1-1.4.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="xref">4.7</a>.  <a href="#name-drift-management" class="xref">Drift Management</a><a href="#section-toc.1-1.4.2.7.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="xref">4.8</a>.  <a href="#name-acknowledgement-and-lost-pa" class="xref">Acknowledgement and Lost Packet Handling</a><a href="#section-toc.1-1.4.2.8.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.4.2.8.2.1">
                    <p id="section-toc.1-1.4.2.8.2.1.1"><a href="#section-4.8.1" class="xref">4.8.1</a>.  <a href="#name-packet-acknowledgement-acks" class="xref">Packet Acknowledgement (ACKs, ACKACKs)</a><a href="#section-toc.1-1.4.2.8.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.8.2.2">
                    <p id="section-toc.1-1.4.2.8.2.2.1"><a href="#section-4.8.2" class="xref">4.8.2</a>.  <a href="#name-packet-retransmission-naks" class="xref">Packet Retransmission (NAKs)</a><a href="#section-toc.1-1.4.2.8.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a href="#section-4.9" class="xref">4.9</a>.  <a href="#name-bidirectional-transmission-" class="xref">Bidirectional Transmission Queues</a><a href="#section-toc.1-1.4.2.9.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.10">
                <p id="section-toc.1-1.4.2.10.1"><a href="#section-4.10" class="xref">4.10</a>. <a href="#name-round-trip-time-estimation" class="xref">Round-Trip Time Estimation</a><a href="#section-toc.1-1.4.2.10.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.11">
                <p id="section-toc.1-1.4.2.11.1"><a href="#section-4.11" class="xref">4.11</a>. <a href="#name-congestion-control" class="xref">Congestion Control</a><a href="#section-toc.1-1.4.2.11.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.4.2.11.2.1">
                    <p id="section-toc.1-1.4.2.11.2.1.1"><a href="#section-4.11.1" class="xref">4.11.1</a>.  <a href="#name-live-congestion-control-liv" class="xref">Live Congestion Control (LiveCC)</a><a href="#section-toc.1-1.4.2.11.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.4.2.11.2.2">
                    <p id="section-toc.1-1.4.2.11.2.2.1"><a href="#section-4.11.2" class="xref">4.11.2</a>.  <a href="#name-file-transfer-congestion-co" class="xref">File Transfer Congestion Control (FileCC)</a><a href="#section-toc.1-1.4.2.11.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-encryption" class="xref">Encryption</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-overview" class="xref">Overview</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-definitions-for-encryption-" class="xref">Definitions for encryption mechanism</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-ciphers-aes-ctr" class="xref">Ciphers (AES-CTR)</a><a href="#section-toc.1-1.5.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-media-stream-message-msmsg" class="xref">Media Stream Message (MSmsg)</a><a href="#section-toc.1-1.5.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="xref">5.2.3</a>.  <a href="#name-keying-material" class="xref">Keying Material</a><a href="#section-toc.1-1.5.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4" class="xref">5.2.4</a>.  <a href="#name-stream-encrypting-key-sek" class="xref">Stream Encrypting Key (SEK)</a><a href="#section-toc.1-1.5.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2.2.5">
                    <p id="section-toc.1-1.5.2.2.2.5.1"><a href="#section-5.2.5" class="xref">5.2.5</a>.  <a href="#name-initialization-vector-iv" class="xref">Initialization Vector (IV)</a><a href="#section-toc.1-1.5.2.2.2.5.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2.2.6">
                    <p id="section-toc.1-1.5.2.2.2.6.1"><a href="#section-5.2.6" class="xref">5.2.6</a>.  <a href="#name-counter-ctr" class="xref">Counter (ctr)</a><a href="#section-toc.1-1.5.2.2.2.6.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2.2.7">
                    <p id="section-toc.1-1.5.2.2.2.7.1"><a href="#section-5.2.7" class="xref">5.2.7</a>.  <a href="#name-keying-material-message-kmm" class="xref">Keying Material message (KMmsg)</a><a href="#section-toc.1-1.5.2.2.2.7.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2.2.8">
                    <p id="section-toc.1-1.5.2.2.2.8.1"><a href="#section-5.2.8" class="xref">5.2.8</a>.  <a href="#name-odd-even-stream-encrypting-" class="xref">Odd/Even Stream Encrypting Key (oSEK/eSEK)</a><a href="#section-toc.1-1.5.2.2.2.8.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.2.2.9">
                    <p id="section-toc.1-1.5.2.2.2.9.1"><a href="#section-5.2.9" class="xref">5.2.9</a>.  <a href="#name-key-encrypting-key-kek" class="xref">Key Encrypting Key (KEK)</a><a href="#section-toc.1-1.5.2.2.2.9.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-encryption-process-walkthro" class="xref">Encryption Process Walkthrough</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="xref">5.3.1</a>.  <a href="#name-stream-configuration" class="xref">Stream configuration</a><a href="#section-toc.1-1.5.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="xref">5.3.2</a>.  <a href="#name-keying-material-generation" class="xref">Keying Material Generation</a><a href="#section-toc.1-1.5.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-to-remove" class="xref">TO Remove</a><a href="#section-toc.1-1.5.2.4.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a href="#section-5.4.1" class="xref">5.4.1</a>.  <a href="#name-keki-to-be-moved-to-a-relev" class="xref">KEKI (to be moved to a relevan section)</a><a href="#section-toc.1-1.5.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref"></a><a href="#name-contributors" class="xref">Contributors</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref"></a><a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref"></a><a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.10.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref"></a><a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.10.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-packet-sequence-list-coding" class="xref">Packet Sequence List coding</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-srt-access-control" class="xref">SRT Access Control</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-b.1" class="xref">B.1</a>.  <a href="#name-general-syntax" class="xref">General Syntax</a><a href="#section-toc.1-1.12.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-b.2" class="xref">B.2</a>.  <a href="#name-standard-keys" class="xref">Standard Keys</a><a href="#section-toc.1-1.12.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc compact ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-b.3" class="xref">B.3</a>.  <a href="#name-examples" class="xref">Examples</a><a href="#section-toc.1-1.12.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.c" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<div id="motivation">
<section id="section-1.1">
        <h3 id="name-motivation">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-motivation" class="section-name selfRef">Motivation</a>
        </h3>
<p id="section-1.1-1">The demand for live video streaming has been increasing steadily for many years. With 
the emergence of cloud technologies, many video processing pipeline components have 
transitioned from on-premises appliances to software running on cloud instances. While 
real-time streaming over TCP-based protocols like RTMP<span>[<a href="#RTMP" class="xref">RTMP</a>]</span> is possible at low bitrates and 
on a small scale, the exponential growth of the streaming market has created a need for 
more powerful solutions.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">To improve scalability on the delivery side, content delivery networks (CDNs) at one 
point transitioned to segmentation-based technologies like HLS (HTTP Live Streaming)<span>[<a href="#RFC8216" class="xref">RFC8216</a>]</span>
and DASH (Dynamic Adaptive Streaming over HTTP)<span>[<a href="#ISO23009" class="xref">ISO23009</a>]</span>. This move increased the end-to-end 
latency of live streaming to over 30 seconds, which makes it unattractive for many 
use cases. Over time, the industry optimized these delivery methods, bringing the 
latency down to 3 seconds.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">While the delivery side scaled up, improvements to video transcoding became a necessity. 
Viewers watch video streams on a variety of different devices, connected over different 
types of networks. Since upload bandwidth from on-premises locations is often limited, 
video transcoding moved to the cloud.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">RTMP became the de facto standard for contribution over the public Internet. But there 
are limitations for the payload to be transmitted, since RTMP as a media specific 
protocol only supports two audio channels and a restricted set of audio and video codecs, 
lacking support for newer formats such as HEVC<span>[<a href="#H.265" class="xref">H.265</a>]</span>, VP9<span>[<a href="#VP9" class="xref">VP9</a>]</span>, or AV1<span>[<a href="#AV1" class="xref">AV1</a>]</span>.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5">Since RTMP, HLS and DASH rely on TCP, these protocols can only guarantee acceptable 
reliability over connections with low RTTs, and can not use the bandwidth of network 
connections to their full extent due to limitations imposed by congestion control. 
Notably, QUIC<span>[<a href="#I-D.ietf-quic-transport" class="xref">I-D.ietf-quic-transport</a>]</span> has been designed to address these problems with HTTP-based delivery 
protocols in HTTP/3<span>[<a href="#I-D.ietf-quic-http" class="xref">I-D.ietf-quic-http</a>]</span>. Like QUIC, SRT<span>[<a href="#SRTSRC" class="xref">SRTSRC</a>]</span> uses UDP instead of the TCP transport protocol,
but assures more reliable delivery using Automatic Repeat Request (ARQ), packet acknowledgments,
end-to-end latency management, etc.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="secure-reliable-transport-protocol">
<section id="section-1.2">
        <h3 id="name-secure-reliable-transport-p">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-secure-reliable-transport-p" class="section-name selfRef">Secure Reliable Transport Protocol</a>
        </h3>
<p id="section-1.2-1">Low latency video transmissions across reliable (usually local) IP based networks 
typically take the form of MPEG-TS<span>[<a href="#ISO13818-1" class="xref">ISO13818-1</a>]</span> unicast or multicast streams using the UDP/RTP 
protocol, where any packet loss can be mitigated by enabling forward error correction 
(FEC). Achieving the same low latency between sites in different cities, countries or 
even continents is more challenging. While it is possible with satellite links or 
dedicated MPLS<span>[<a href="#RFC3031" class="xref">RFC3031</a>]</span> networks, these are expensive solutions. The use of public Internet 
connectivity, while less expensive, imposes significant bandwidth overhead to achieve 
the necessary level of packet loss recovery. Introducing selective packet retransmission 
(reliable UDP) to recover from packet loss removes those limitations.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">Derived from the UDP-based Data Transfer protocol<span>[<a href="#GHG04b" class="xref">GHG04b</a>]</span> (UDT), SRT is a user-level protocol 
that retains most of the core concepts and mechanisms while introducing several 
refinements and enhancements, including control packet modifications, improved flow 
control for handling live streaming, enhanced congestion control, and a mechanism for 
encrypting packets.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">SRT is a transport protocol that enables the secure, reliable transport of data across 
unpredictable networks, such as the Internet. While any data type can be transferred 
via SRT, it is ideal for low latency (sub-second) video streaming. SRT provides 
improved bandwidth utilization compared to RTMP, allowing much higher 
contribution bitrates over long distance connections.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4">As packets are streamed from source to destination, SRT detects and adapts to the 
real-time network conditions between the two endpoints, and helps compensate for 
jitter and bandwidth fluctuations due to congestion over noisy networks. Its error 
recovery mechanism minimizes the packet loss typical of Internet connections.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<p id="section-1.2-5">To achieve low latency streaming, SRT had to address timing issues. The characteristics 
of a stream from a source network are completely changed by transmission over the public 
Internet, which introduces delays, jitter, and packet loss. This, in turn, leads to 
problems with decoding, as the audio and video decoders do not receive packets at the 
expected times. The use of large buffers helps, but latency is increased. 
SRT includes a mechanism to keep a constant end-to-end latency, thus recreating
the signal characteristics on the receiver side, and reducing the need for buffering.<a href="#section-1.2-5" class="pilcrow">¶</a></p>
<p id="section-1.2-6">Like TCP, SRT employs a listener/caller model. The data flow is bi-directional and 
independent of the connection initiation - either the sender or receiver can operate 
as listener or caller to initiate a connection. The protocol provides an internal 
multiplexing mechanism, allowing multiple SRT connections to share the same UDP port, 
providing access control functionality to identify the caller on the listener side.<a href="#section-1.2-6" class="pilcrow">¶</a></p>
<p id="section-1.2-7">Supporting forward error correction (FEC) and selective packet retransmission (ARQ), 
SRT provides the flexibility to use either of the two mechanisms or both combined, 
allowing for use cases ranging from the lowest possible latency to the highest possible 
reliability.<a href="#section-1.2-7" class="pilcrow">¶</a></p>
<p id="section-1.2-8">SRT maintains the ability for fast file transfers introduced in UDT, and adds support 
for AES encryption.<a href="#section-1.2-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="terms-and-definitions">
<section id="section-2">
      <h2 id="name-terms-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terms-and-definitions" class="section-name selfRef">Terms and Definitions</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span>
when, and only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-2">
        <dt id="section-2-2.1">SRT:</dt>
        <dd id="section-2-2.2">
  The Secure Reliable Transport protocol described by this document.<a href="#section-2-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.3">PRNG:</dt>
        <dd id="section-2-2.4">
  Pseudo-Random Number Generator.<a href="#section-2-2.4" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="packet-structure">
<section id="section-3">
      <h2 id="name-packet-structure">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-packet-structure" class="section-name selfRef">Packet Structure</a>
      </h2>
<p id="section-3-1">SRT packets are transmitted in UDP packets <span>[<a href="#RFC0768" class="xref">RFC0768</a>]</span>. Every UDP packet carrying SRT 
traffic contains an SRT header (immediately after the UDP header).<a href="#section-3-1" class="pilcrow">¶</a></p>
<span id="name-srt-packet-as-udp-payload"></span><div id="srt-in-udp">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-3-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            SrcPort            |            DstPort            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              Len              |            ChkSum             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                          SRT Packet                           +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-srt-packet-as-udp-payload" class="selfRef">SRT packet as UDP payload</a>
        </figcaption></figure>
</div>
<p id="section-3-3">SRT has two types of packets distinguished by the Packet Type Flag:
data packet and control packet.
The structure of the SRT packet is shown in <a href="#srtpacket" class="xref">Figure 2</a>.<a href="#section-3-3" class="pilcrow">¶</a></p>
<span id="name-srt-packet-structure"></span><div id="srtpacket">
<figure id="figure-2">
        <div class="artwork art-text alignLeft" id="section-3-4.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|F|        (Field meaning depends on the packet type)           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          (Field meaning depends on the packet type)           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Timestamp                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Destination Socket ID                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- CIF -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                        Packet Contents                        |
|                  (depends on the packet type)                 +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-srt-packet-structure" class="selfRef">SRT packet structure</a>
        </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3-5">
        <dt id="section-3-5.1">F (1 bit):</dt>
        <dd id="section-3-5.2">
  Packet Type Flag. The control packet has this flag set to "1".
The data packet has this flag set to "0".<a href="#section-3-5.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-5.3">Timestamp (32 bits):</dt>
        <dd id="section-3-5.4">
  The time stamp of the packet in microseconds.
The value is relative to the time the SRT connection was established.
Depending on the transmission mode (<a href="#data-transmission-mode" class="xref">Section 4.2</a>),
the field stores the packet send time or the packet origin time.<a href="#section-3-5.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-5.5">Destination Socket ID (32 bits):</dt>
        <dd id="section-3-5.6">
  A fixed-width field providing the SRT socket ID to which a packet should be dispatched.
The field may have the special value "0" when the packet is a connection request.<a href="#section-3-5.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<div id="data-pkt">
<section id="section-3.1">
        <h3 id="name-data-packets">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-data-packets" class="section-name selfRef">Data Packets</a>
        </h3>
<p id="section-3.1-1">The structure of the SRT data packet is shown in <a href="#srtdatapacket" class="xref">Figure 3</a>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<span id="name-data-packet-structure"></span><div id="srtdatapacket">
<figure id="figure-3">
          <div class="artwork art-text alignLeft" id="section-3.1-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|                    Packet Sequence Number                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|P P|O|K K|R|                   Message Number                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Timestamp                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Destination Socket ID                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                              Data                             +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-data-packet-structure" class="selfRef">Data packet structure</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.1-3">
          <dt id="section-3.1-3.1">Packet Sequence Number (31 bits):</dt>
          <dd id="section-3.1-3.2">
  The sequential number of the data packet.<a href="#section-3.1-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.3">PP (2 bits):</dt>
          <dd id="section-3.1-3.4">
  Packet Position Flag. This field indicates the position of the data packet in the message.
The value "10b" (binary) means the first packet of the message. "00b" indicates a packet 
in the middle. "01b" designates the last packet. If a single data packet forms the whole 
message, the value is "11b".<a href="#section-3.1-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.5">O (1 bit):</dt>
          <dd id="section-3.1-3.6">
  Order Flag. Indicates whether the message should be delivered by the receiver in order (1) 
or not (0). Certain restrictions apply depending on the data transmission mode used 
(<a href="#data-transmission-mode" class="xref">Section 4.2</a>).<a href="#section-3.1-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.7">KK (2 bits):</dt>
          <dd id="section-3.1-3.8">
  Key-based Encryption Flag. The flag bits indicate whether or not data is encrypted.
The value "00b" (binary) means data is not encrypted. "01b" indicates that data is
encrypted with an even key, and "10b" is used for odd key encryption. Refer to <a href="#encryption" class="xref">Section 5</a>.
The value "11b" is only used in control packets.<a href="#section-3.1-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.9">R (1 bit):</dt>
          <dd id="section-3.1-3.10">
  Retransmitted Packet Flag. This flag is clear when a packet is transmitted the first time.
The flag is set to "1" when a packet is retransmitted.<a href="#section-3.1-3.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.11">Message Number (26 bits):</dt>
          <dd id="section-3.1-3.12">
  The sequential number of consecutive data packets that form a message (see PP field).<a href="#section-3.1-3.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.13">Data (variable length):</dt>
          <dd id="section-3.1-3.14">
  The payload of the data packet. The length of the data is the remaining length of 
the UDP packet.<a href="#section-3.1-3.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="control-packets">
<section id="section-3.2">
        <h3 id="name-control-packets">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-control-packets" class="section-name selfRef">Control Packets</a>
        </h3>
<p id="section-3.2-1">An SRT control packet has the following structure.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<span id="name-control-packet-structure"></span><div id="controlpacket">
<figure id="figure-4">
          <div class="artwork art-text alignLeft" id="section-3.2-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|         Control Type        |            Subtype            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Type-specific Information                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Timestamp                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Destination Socket ID                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- CIF -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                   Control Information Field                   +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-control-packet-structure" class="selfRef">Control packet structure</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2-3">
          <dt id="section-3.2-3.1">Control Type (15 bits):</dt>
          <dd id="section-3.2-3.2">
  Control Packet Type. The use of these bits is determined
by the control packet type definition. See <a href="#srt-ctrl-pkt-type-table" class="xref">Table 1</a>.<a href="#section-3.2-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-3.3">Subtype (16 bits):</dt>
          <dd id="section-3.2-3.4">
  This field specifies an additional subtype for specific packets.
See <a href="#srt-ctrl-pkt-type-table" class="xref">Table 1</a>.<a href="#section-3.2-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-3.5">Type-specific Information (32 bits):</dt>
          <dd id="section-3.2-3.6">
  The use of this field depends on the particular control
packet type. Handshake packets do not use this field.<a href="#section-3.2-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-3.7">Control Information Field (variable length):</dt>
          <dd id="section-3.2-3.8">
  The use of this field is defined by the Control Type field of the control packet.<a href="#section-3.2-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.2-4">The types of SRT control packets are shown in <a href="#srt-ctrl-pkt-type-table" class="xref">Table 1</a>.
The value "0x7FFF" is reserved for a user-defined type.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<span id="name-srt-control-packet-types"></span><div id="srt-ctrl-pkt-type-table">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-srt-control-packet-types" class="selfRef">SRT Control Packet Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Packet Type</th>
              <th class="text-center" rowspan="1" colspan="1">Control Type</th>
              <th class="text-center" rowspan="1" colspan="1">Subtype</th>
              <th class="text-left" rowspan="1" colspan="1">Section</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">HANDSHAKE</td>
              <td class="text-center" rowspan="1" colspan="1">0x0000</td>
              <td class="text-center" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ctrl-pkt-handshake" class="xref">Section 3.2.1</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">KEEPALIVE</td>
              <td class="text-center" rowspan="1" colspan="1">0x0001</td>
              <td class="text-center" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ctrl-pkt-keepalive" class="xref">Section 3.2.2</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ACK</td>
              <td class="text-center" rowspan="1" colspan="1">0x0002</td>
              <td class="text-center" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ctrl-pkt-ack" class="xref">Section 3.2.3</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">NAK (Loss Report)</td>
              <td class="text-center" rowspan="1" colspan="1">0x0003</td>
              <td class="text-center" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ctrl-pkt-nak" class="xref">Section 3.2.4</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SHUTDOWN</td>
              <td class="text-center" rowspan="1" colspan="1">0x0005</td>
              <td class="text-center" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ctrl-pkt-shutdown" class="xref">Section 3.2.5</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ACKACK</td>
              <td class="text-center" rowspan="1" colspan="1">0x0006</td>
              <td class="text-center" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ctrl-pkt-ackack" class="xref">Section 3.2.6</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">User-Defined Type</td>
              <td class="text-center" rowspan="1" colspan="1">0x7FFF</td>
              <td class="text-center" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
            </tr>
          </tbody>
        </table>
</div>
<div id="ctrl-pkt-handshake">
<section id="section-3.2.1">
          <h4 id="name-handshake">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-handshake" class="section-name selfRef">Handshake</a>
          </h4>
<p id="section-3.2.1-1">Handshake control packets (Control Type = 0x0000) are used to exchange peer configurations,
to agree on connection parameters, and to establish a connection.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">The Control Information Field (CIF) of a handshake control packet is shown 
in <a href="#handshake-packet-structure" class="xref">Figure 5</a>.<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<span id="name-handshake-packet-structure"></span><div id="handshake-packet-structure">
<figure id="figure-5">
            <div class="artwork art-text alignLeft" id="section-3.2.1-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            Version                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Encryption Field       |        Extension Field        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                 Initial Packet Sequence Number                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                 Maximum Transmission Unit Size                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Maximum Flow Window Size                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Handshake Type                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         SRT Socket ID                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           SYN Cookie                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                                                               |
+                        Peer IP Address                        +
|                                                               |
+                                                               +
|                                                               |
+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
|         Extension Type        |        Extension Length       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                       Extension Contents                      +
|                                                               |
+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-handshake-packet-structure" class="selfRef">Handshake packet structure</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1-4">
            <dt id="section-3.2.1-4.1">Version (32 bits):</dt>
            <dd id="section-3.2.1-4.2">
  A base protocol version number. Currently used values are 4 and 5.
Values greater than 5 are reserved for future use.<a href="#section-3.2.1-4.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-4.3">Encryption Field (16 bits):</dt>
            <dd id="section-3.2.1-4.4">
  Block cipher family and block size. The values of this field are
described in <a href="#handshake-encr-fld" class="xref">Table 2</a>.<a href="#section-3.2.1-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-handshake-encryption-field-"></span><div id="handshake-encr-fld">
<table class="center" id="table-2">
            <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-handshake-encryption-field-" class="selfRef">Handshake Encryption Field Values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
                <th class="text-center" rowspan="1" colspan="1">Cipher family and block size</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-center" rowspan="1" colspan="1">No Encryption</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2</td>
                <td class="text-center" rowspan="1" colspan="1">AES-128</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">3</td>
                <td class="text-center" rowspan="1" colspan="1">AES-192</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">4</td>
                <td class="text-center" rowspan="1" colspan="1">AES-256</td>
              </tr>
            </tbody>
          </table>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1-6">
            <dt id="section-3.2.1-6.1">Extension Field (16 bits):</dt>
            <dd id="section-3.2.1-6.2">
  This field is message specific extension related to Handshake Type field.
The value must be set to 0 except for the following cases.

(1) If the handshake control packet is the INDUCTION message, this field is 
sent back by the Listener. 
(2) In the case of a CONCLUSION message, this field value should contain a combination 
of Extension Type values.
For more details, see <a href="#caller-listener-handshake" class="xref">Section 4.3.1</a>.<a href="#section-3.2.1-6.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-handshake-extension-flags"></span><div id="hs-ext-flags">
<table class="center" id="table-3">
            <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-handshake-extension-flags" class="selfRef">Handshake Extension Flags</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Bitmask</th>
                <th class="text-center" rowspan="1" colspan="1">Flag</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x00000001</td>
                <td class="text-center" rowspan="1" colspan="1">HSREQ</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x00000002</td>
                <td class="text-center" rowspan="1" colspan="1">KMREQ</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x00000004</td>
                <td class="text-center" rowspan="1" colspan="1">CONFIG</td>
              </tr>
            </tbody>
          </table>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1-8">
            <dt id="section-3.2.1-8.1">Initial Packet Sequence Number (32 bits):</dt>
            <dd id="section-3.2.1-8.2">
  The sequence number of the very first data packet to be sent.<a href="#section-3.2.1-8.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-8.3">Maximum Transmission Unit Size (32 bits):</dt>
            <dd id="section-3.2.1-8.4">
  This value is typically set to 1500, which is the default Maximum Transmission Unit (MTU) 
size for Ethernet, but can be less.<a href="#section-3.2.1-8.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-8.5">Maximum Flow Window Size (32 bits):</dt>
            <dd id="section-3.2.1-8.6">
              <p id="section-3.2.1-8.6.1">
  The value of this field is the maximum number of data packets allowed to be "in flight"<a href="#section-3.2.1-8.6.1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-8.6.2">
(i.e. the number of sent packets for which an ACK control packet has not yet been received).<a href="#section-3.2.1-8.6.2" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-8.7">Handshake Type (32 bits):</dt>
            <dd id="section-3.2.1-8.8">
  This field indicates the handshake packet type.
The possible values are described in <a href="#handshake-type" class="xref">Table 4</a>.
For more details refer to <a href="#handshake-messages" class="xref">Section 4.3</a>.<a href="#section-3.2.1-8.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-handshake-type"></span><div id="handshake-type">
<table class="center" id="table-4">
            <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-handshake-type" class="selfRef">Handshake Type</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
                <th class="text-center" rowspan="1" colspan="1">Handshake type</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0xFFFFFFFD</td>
                <td class="text-center" rowspan="1" colspan="1">DONE</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0xFFFFFFFE</td>
                <td class="text-center" rowspan="1" colspan="1">AGREEMENT</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0xFFFFFFFF</td>
                <td class="text-center" rowspan="1" colspan="1">CONCLUSION</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x00000000</td>
                <td class="text-center" rowspan="1" colspan="1">WAVEHAND</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x00000001</td>
                <td class="text-center" rowspan="1" colspan="1">INDUCTION</td>
              </tr>
            </tbody>
          </table>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1-10">
            <dt id="section-3.2.1-10.1">SRT Socket ID (32 bits):</dt>
            <dd id="section-3.2.1-10.2">
  This field holds the ID of the source SRT socket from which a handshake packet is issued.<a href="#section-3.2.1-10.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-10.3">SYN Cookie (32 bits):</dt>
            <dd id="section-3.2.1-10.4">
  Randomized value for processing a handshake. The value of this field is specified
by the handshake message type. See <a href="#handshake-messages" class="xref">Section 4.3</a>.<a href="#section-3.2.1-10.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-10.5">Peer IP Address (128 bits):</dt>
            <dd id="section-3.2.1-10.6">
  IPv4 or IPv6 address of the packet's sender. The value consists of four 32-bit fields.
In the case of IPv4 addresses, fields 2, 3 and 4 are filled with zeroes.<a href="#section-3.2.1-10.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-10.7">Extension Type (16 bits):</dt>
            <dd id="section-3.2.1-10.8">
  The value of this field is used to process an integrated handshake.
There are two extensions: Handshake Extension Message (<a href="#handshake-extension-msg" class="xref">Section 3.2.1.1</a>)
and Key Material Exchange (<a href="#key-material-exchange" class="xref">Section 3.2.1.2</a>).
Each extension can have a pair of request and response types.<a href="#section-3.2.1-10.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-handshake-extension-type-va"></span><div id="handshake-ext-type">
<table class="center" id="table-5">
            <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-handshake-extension-type-va" class="selfRef">Handshake Extension Type values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
                <th class="text-center" rowspan="1" colspan="1">Extension Type</th>
                <th class="text-center" rowspan="1" colspan="1">HS Extension Flag</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1</td>
                <td class="text-center" rowspan="1" colspan="1">SRT_CMD_HSREQ</td>
                <td class="text-center" rowspan="1" colspan="1">HSREQ</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2</td>
                <td class="text-center" rowspan="1" colspan="1">SRT_CMD_HSRSP</td>
                <td class="text-center" rowspan="1" colspan="1">HSREQ</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">3</td>
                <td class="text-center" rowspan="1" colspan="1">SRT_CMD_KMREQ</td>
                <td class="text-center" rowspan="1" colspan="1">KMREQ</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">4</td>
                <td class="text-center" rowspan="1" colspan="1">SRT_CMD_KMRSP</td>
                <td class="text-center" rowspan="1" colspan="1">KMREQ</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">5</td>
                <td class="text-center" rowspan="1" colspan="1">SRT_CMD_SID</td>
                <td class="text-center" rowspan="1" colspan="1">CONFIG</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">6</td>
                <td class="text-center" rowspan="1" colspan="1">SRT_CMD_CONGESTION</td>
                <td class="text-center" rowspan="1" colspan="1">CONFIG</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">7</td>
                <td class="text-center" rowspan="1" colspan="1">SRT_CMD_FILTER</td>
                <td class="text-center" rowspan="1" colspan="1">CONFIG</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">8</td>
                <td class="text-center" rowspan="1" colspan="1">SRT_CMD_GROUP</td>
                <td class="text-center" rowspan="1" colspan="1">CONFIG</td>
              </tr>
            </tbody>
          </table>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1-12">
            <dt id="section-3.2.1-12.1">Extension Length (16 bits):</dt>
            <dd id="section-3.2.1-12.2">
  The length of the Extension Contents field in four-byte blocks.<a href="#section-3.2.1-12.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-12.3">Extension Contents (variable length):</dt>
            <dd id="section-3.2.1-12.4">
  The payload of the extension.<a href="#section-3.2.1-12.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<div id="handshake-extension-msg">
<section id="section-3.2.1.1">
            <h5 id="name-handshake-extension-message">
<a href="#section-3.2.1.1" class="section-number selfRef">3.2.1.1. </a><a href="#name-handshake-extension-message" class="section-name selfRef">Handshake Extension Message</a>
            </h5>
<p id="section-3.2.1.1-1">In a Handshake Extension, the value of the Extension Field of the
handshake control packet is defined as 1 for a Handshake Extension request (SRT_CMD_HSREQ in <a href="#handshake-ext-type" class="xref">Table 5</a>),
and 2 for a Handshake Extension response (SRT_CMD_HSRSP in <a href="#handshake-ext-type" class="xref">Table 5</a>).<a href="#section-3.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1.1-2">The Extension Contents field of a Handshake Extension Message is structured as follows:<a href="#section-3.2.1.1-2" class="pilcrow">¶</a></p>
<span id="name-handshake-extension-message-"></span><div id="handshake-extension-msg-structure">
<figure id="figure-6">
              <div class="artwork art-text alignLeft" id="section-3.2.1.1-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          SRT Version                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           SRT Flags                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Receiver TSBPD Delay     |       Sender TSBPD Delay      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-handshake-extension-message-" class="selfRef">Handshake Extension Message structure</a>
              </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1.1-4">
              <dt id="section-3.2.1.1-4.1">SRT Version (32 bits):</dt>
              <dd id="section-3.2.1.1-4.2">
  SRT library version MUST be formed as major * 0x10000 + minor * 0x100 + patch.<a href="#section-3.2.1.1-4.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.1-4.3">SRT Flags (32 bits):</dt>
              <dd id="section-3.2.1.1-4.4">
  SRT configuration flags (see <a href="#hs-ext-msg-flags" class="xref">Section 3.2.1.1.1</a>).<a href="#section-3.2.1.1-4.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.1-4.5">Receiver TSBPD Delay (16 bits):</dt>
              <dd id="section-3.2.1.1-4.6">
  TimeStamp-Based Packet Delivery (TSBPD) Delay of the receiver. Refer to <a href="#tsbpd" class="xref">Section 4.5</a>.<a href="#section-3.2.1.1-4.6" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.1-4.7">Sender TSBPD Delay (16 bits):</dt>
              <dd id="section-3.2.1.1-4.8">
  TSBPD of the sender. Refer to <a href="#tsbpd" class="xref">Section 4.5</a>.<a href="#section-3.2.1.1-4.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<div id="hs-ext-msg-flags">
<section id="section-3.2.1.1.1">
              <h6 id="name-handshake-extension-message-f">
<a href="#section-3.2.1.1.1" class="section-number selfRef">3.2.1.1.1. </a><a href="#name-handshake-extension-message-f" class="section-name selfRef">Handshake Extension Message Flags</a>
              </h6>
<span id="name-handshake-extension-message-fl"></span><div id="hs-ext-msg-flags-tbl">
<table class="center" id="table-6">
                <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-handshake-extension-message-fl" class="selfRef">Handshake Extension Message Flags</a>
                </caption>
<thead>
                  <tr>
                    <th class="text-left" rowspan="1" colspan="1">Bitmask</th>
                    <th class="text-center" rowspan="1" colspan="1">Flag</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0x00000001</td>
                    <td class="text-center" rowspan="1" colspan="1">TSBPDSND</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0x00000002</td>
                    <td class="text-center" rowspan="1" colspan="1">TSBPDRCV</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0x00000004</td>
                    <td class="text-center" rowspan="1" colspan="1">CRYPT</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0x00000008</td>
                    <td class="text-center" rowspan="1" colspan="1">TLPKTDROP</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0x00000010</td>
                    <td class="text-center" rowspan="1" colspan="1">PERIODICNAK</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0x00000020</td>
                    <td class="text-center" rowspan="1" colspan="1">REXMITFLG</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0x00000040</td>
                    <td class="text-center" rowspan="1" colspan="1">STREAM</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0x00000080</td>
                    <td class="text-center" rowspan="1" colspan="1">PACKET_FILTER</td>
                  </tr>
                </tbody>
              </table>
</div>
<ul class="normal">
<li class="normal" id="section-3.2.1.1.1-2.1">TSBPDSND flag defines if the TSBPD mechanism (<a href="#tsbpd" class="xref">Section 4.5</a>) will be used for sending.<a href="#section-3.2.1.1.1-2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.2.1.1.1-2.2">TSBPDRCV flag defines if the TSBPD mechanism (<a href="#tsbpd" class="xref">Section 4.5</a>) will be used for receiving.<a href="#section-3.2.1.1.1-2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.2.1.1.1-2.3">CRYPT flag MUST be set. It is a legacy flag that indicates the party understands 
KK field of the SRT Packet (<a href="#srtdatapacket" class="xref">Figure 3</a>).<a href="#section-3.2.1.1.1-2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.2.1.1.1-2.4">TLPKTDROP flag should be set if too-late packet drop mechanism will be used during transmission.
See <a href="#too-late-packet-drop" class="xref">Section 4.6</a>.<a href="#section-3.2.1.1.1-2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.2.1.1.1-2.5">PERIODICNAK flag set indicates the peer will send periodic NAK packets. See <a href="#packet-naks" class="xref">Section 4.8.2</a>.<a href="#section-3.2.1.1.1-2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.2.1.1.1-2.6">REXMITFLG flag MUST be set. It is a legacy flag that indicates the peer understands the R field
of the SRT DATA Packet (<a href="#srtdatapacket" class="xref">Figure 3</a>).<a href="#section-3.2.1.1.1-2.6" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.2.1.1.1-2.7">STREAM flag identifies the transmission mode (<a href="#data-transmission-mode" class="xref">Section 4.2</a>) to be used in the connection.
If the flag is set the buffer mode (<a href="#transmission-mode-buffer" class="xref">Section 4.2.3</a>) will be used.
Otherwise, message mode (<a href="#transmission-mode-msg" class="xref">Section 4.2.1</a>) is to be used.<a href="#section-3.2.1.1.1-2.7" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.2.1.1.1-2.8">PACKET_FILTER flag indicates if the peer supports packet filter.<a href="#section-3.2.1.1.1-2.8" class="pilcrow">¶</a>
</li>
              </ul>
</section>
</div>
</section>
</div>
<div id="key-material-exchange">
<section id="section-3.2.1.2">
            <h5 id="name-key-material-exchange">
<a href="#section-3.2.1.2" class="section-number selfRef">3.2.1.2. </a><a href="#name-key-material-exchange" class="section-name selfRef">Key Material Exchange</a>
            </h5>
<p id="section-3.2.1.2-1">The purpose of the Key Material Exchange extension of a Handshake packet
is to let peers exchange and negotiate encryption-related information to be used to encrypt and decrypt the payload of the stream.
The extension can be supplied with the Handshake Extension Type field set
to either SRT_CMD_KMREQ or SRT_CMD_HSRSP (see <a href="#handshake-ext-type" class="xref">Table 5</a> in <a href="#ctrl-pkt-handshake" class="xref">Section 3.2.1</a>).
For more details refer to <a href="#handshake-messages" class="xref">Section 4.3</a>.<a href="#section-3.2.1.2-1" class="pilcrow">¶</a></p>
<span id="name-key-material-extension-stru"></span><div id="keymaterial-extension-structure">
<figure id="figure-7">
              <div class="artwork art-text alignLeft" id="section-3.2.1.2-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|S|  V  |   PT  |              Sign             |   Resv1   | KK|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              KEKI                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Cipher    |      Auth     |       SE      |     Resv2     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             Resv3             |      SLen     |      KLen     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              Salt                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                          Wrapped Key                          +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-key-material-extension-stru" class="selfRef">Key Material Extension structure</a>
              </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1.2-3">
              <dt id="section-3.2.1.2-3.1">S ( ): 1 bit. Value: {0}</dt>
              <dd id="section-3.2.1.2-3.2">
  This is a fixed-width field that is a remnant from the header of a previous design.<a href="#section-3.2.1.2-3.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.2-3.3">Version (V): 3 bits. Value: {1}</dt>
              <dd id="section-3.2.1.2-3.4">
                <p id="section-3.2.1.2-3.4.1">
  This is a fixed-width field that indicates the SRT version:<a href="#section-3.2.1.2-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1.2-3.4.2.1">1: initial version<a href="#section-3.2.1.2-3.4.2.1" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.2-3.5">Packet Type (PT): 4 bits. Value: {2}</dt>
              <dd id="section-3.2.1.2-3.6">
                <p id="section-3.2.1.2-3.6.1">
  This is a fixed-width field that indicates the Packet Type:<a href="#section-3.2.1.2-3.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1.2-3.6.2.1">0: Reserved<a href="#section-3.2.1.2-3.6.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-3.2.1.2-3.6.2.2">1: Media Stream Message (MSmsg)<a href="#section-3.2.1.2-3.6.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-3.2.1.2-3.6.2.3">2: Keying Material Message (KMmsg)<a href="#section-3.2.1.2-3.6.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-3.2.1.2-3.6.2.4">7: Reserved to discriminate MPEG-TS packet (0x47=sync byte)<a href="#section-3.2.1.2-3.6.2.4" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.2-3.7">Sign (Sign): 16 bits. Value: {0x2029}</dt>
              <dd id="section-3.2.1.2-3.8">
  This is a fixed-width field that contains the signature 'HAI' encoded as a 
PnP Vendor ID (<span>[<a href="#PNPID" class="xref">PNPID</a>]</span>) (in big-endian order)<a href="#section-3.2.1.2-3.8" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.2-3.9">Resv1 ( ): 6 bits. Value: {0}</dt>
              <dd id="section-3.2.1.2-3.10">
  This is a fixed-width field reserved for flag extension or other usage.<a href="#section-3.2.1.2-3.10" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.2-3.11">Key-based Encryption (KK): 2 bits.</dt>
              <dd id="section-3.2.1.2-3.12">
                <p id="section-3.2.1.2-3.12.1">
  This is a fixed-width field that indicates which SEKs (odd and/or even) are provided in the extension:<a href="#section-3.2.1.2-3.12.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1.2-3.12.2.1">00b: no SEK is provided (invalid extension format)<a href="#section-3.2.1.2-3.12.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-3.2.1.2-3.12.2.2">01b: even key is provided<a href="#section-3.2.1.2-3.12.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-3.2.1.2-3.12.2.3">10b: odd key is provided<a href="#section-3.2.1.2-3.12.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-3.2.1.2-3.12.2.4">11b: both even and odd keys are provided<a href="#section-3.2.1.2-3.12.2.4" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.2-3.13">Key Encryption Key Index (KEKI): 32 bits. Value: {0}</dt>
              <dd id="section-3.2.1.2-3.14">
                <p id="section-3.2.1.2-3.14.1">
  This is a fixed-width field for specifying the KEK index (big-endian order)
was used to wrap (and optionally authenticate) the SEK(s).
The value 0 is used to indicate the default key of the current stream.
Other values are reserved for the possible use of a key management system in the future
to retrieve a cryptographic context.<a href="#section-3.2.1.2-3.14.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1.2-3.14.2.1">0: Default stream associated key (stream/system default)<a href="#section-3.2.1.2-3.14.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-3.2.1.2-3.14.2.2">1..255: Reserved for manually indexed keys<a href="#section-3.2.1.2-3.14.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.2-3.15">Cipher ( ): 8 bits. Value: {0..2}</dt>
              <dd id="section-3.2.1.2-3.16">
                <p id="section-3.2.1.2-3.16.1">
  This is a fixed-width field for specifying encryption cipher and mode:<a href="#section-3.2.1.2-3.16.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1.2-3.16.2.1">0: None or KEKI indexed crypto context<a href="#section-3.2.1.2-3.16.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-3.2.1.2-3.16.2.2">1: AES-ECB (not supported in SRT)<a href="#section-3.2.1.2-3.16.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-3.2.1.2-3.16.2.3">2: AES-CTR <span>[<a href="#SP800-38A" class="xref">SP800-38A</a>]</span><a href="#section-3.2.1.2-3.16.2.3" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.2-3.17">Authentication (Auth): 8 bits. Value: {0}</dt>
              <dd id="section-3.2.1.2-3.18">
                <p id="section-3.2.1.2-3.18.1">
  This is a fixed-width field for specifying a message authentication code algorithm:<a href="#section-3.2.1.2-3.18.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1.2-3.18.2.1">0: None or KEKI indexed crypto context<a href="#section-3.2.1.2-3.18.2.1" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.2-3.19">Stream Encapsulation (SE): 8 bits. Value: {2}</dt>
              <dd id="section-3.2.1.2-3.20">
                <p id="section-3.2.1.2-3.20.1">
  This is a fixed-width field for describing the stream encapsulation:<a href="#section-3.2.1.2-3.20.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1.2-3.20.2.1">0: Unspecified or KEKI indexed crypto context<a href="#section-3.2.1.2-3.20.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-3.2.1.2-3.20.2.2">1: MPEG-TS/UDP<a href="#section-3.2.1.2-3.20.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-3.2.1.2-3.20.2.3">2: MPEG-TS/SRT<a href="#section-3.2.1.2-3.20.2.3" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.2-3.21">Resv2 ( ): 8 bits. Value: {0}</dt>
              <dd id="section-3.2.1.2-3.22">
  This is a fixed-width field reserved for future use.<a href="#section-3.2.1.2-3.22" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.2-3.23">Resv3 ( ): 16 bits. Value: {0}</dt>
              <dd id="section-3.2.1.2-3.24">
  This is a fixed-width field reserved for future use.<a href="#section-3.2.1.2-3.24" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.2-3.25">Slen ( ): 8 bits. Value: {0..255}</dt>
              <dd id="section-3.2.1.2-3.26">
  This is a fixed-width field for specifying salt length in bytes divided by 4.
Can be zero if no salt/IV present<a href="#section-3.2.1.2-3.26" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.2-3.27">Klen ( ): 8 bits. Value: {4,6,8}</dt>
              <dd id="section-3.2.1.2-3.28">
  This is a fixed-width field for specifying SEK length in bytes divided by 4.
Size of one key even if two keys present.<a href="#section-3.2.1.2-3.28" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.2-3.29">Salt (Slen): Slen * 4 * 8 bits. Value: { }</dt>
              <dd id="section-3.2.1.2-3.30">
  This is a variable-width field that complements the keying material by specifying a salt key.<a href="#section-3.2.1.2-3.30" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.2-3.31">Wrap ( ): (64+n * Klen * 4 * 8) bits. Value: { }</dt>
              <dd id="section-3.2.1.2-3.32">
  This is a variable-width field for specifying Wrapped key(s), where n = (KK + 1)/2 and
the size of the wrap field is ((n * Klen * 4) + 8) bytes.<a href="#section-3.2.1.2-3.32" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<span id="name-unwrapped-key-structure"></span><div id="unwrapped-key-structure">
<figure id="figure-8">
              <div class="artwork art-text alignLeft" id="section-3.2.1.2-4.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                  Integrity Check Vector (ICV)                 +
|                                                               |
+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
|                              xSEK                             |
+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
|                              oSEK                             |
+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-unwrapped-key-structure" class="selfRef">Unwrapped key structure</a>
              </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1.2-5">
              <dt id="section-3.2.1.2-5.1">ICV (64 bits):</dt>
              <dd id="section-3.2.1.2-5.2">
  64-bit Integrity Check Vector(AES key wrap integrity).
This field is used to detect if the keys were unwrapped properly.
If the KEK in hand is invalid, validation fails and unwrapped keys are discarded.<a href="#section-3.2.1.2-5.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.2-5.3">xSEK (variable width):</dt>
              <dd id="section-3.2.1.2-5.4">
  This field identifies an odd or even SEK. If only one key is present, the bit set in the KK field tells which SEK is provided.
If both keys are present, then this field is eSEK (even key) and it is followed by odd key oSEK.
The length of this field is calculated as KLen * 4 * 8.<a href="#section-3.2.1.2-5.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.2-5.5">oSEK (variable width):</dt>
              <dd id="section-3.2.1.2-5.6">
  This field with the odd key is present only when the message carries the two SEKs (identified by he KK field).<a href="#section-3.2.1.2-5.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-hsext-streamid">
<section id="section-3.2.1.3">
            <h5 id="name-stream-id-extension-message">
<a href="#section-3.2.1.3" class="section-number selfRef">3.2.1.3. </a><a href="#name-stream-id-extension-message" class="section-name selfRef">Stream ID Extension Message</a>
            </h5>
<p id="section-3.2.1.3-1">The Stream ID handshake extension message can be used to identify the stream content, 
The Stream ID value can be used as free-form, but there is also recommended convention
that can be used to achieve interoperability.<a href="#section-3.2.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1.3-2">The Stream ID handshake extension message has SRT_CMD_SID extension type (see <a href="#handshake-ext-type" class="xref">Table 5</a>.
The extension contents holds a sequence of UTF-8 characters. The maximum allowed size of the
SrteamID extension is 512 bytes.<a href="#section-3.2.1.3-2" class="pilcrow">¶</a></p>
<span id="name-stream-id-extension-message-2"></span><div id="fig-hsext-streamid">
<figure id="figure-9">
              <div class="artwork art-text alignLeft" id="section-3.2.1.3-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                           Stream ID                           |
                               ...
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-stream-id-extension-message-2" class="selfRef">Stream ID Extension Message</a>
              </figcaption></figure>
</div>
<p id="section-3.2.1.3-4">The Extension Contents field holds a sequence of UTF-8 characters (see <a href="#fig-hsext-streamid" class="xref">Figure 9</a>).
The maximum allowed size of the SrteamID extension is 512 bytes. The actual size is determined
by the Extension Length field (<a href="#handshake-packet-structure" class="xref">Figure 5</a>), which defines the length in
four byte blocks. If the actual payload is less than the declared length, the remaining bytes are set to zeros.<a href="#section-3.2.1.3-4" class="pilcrow">¶</a></p>
<p id="section-3.2.1.3-5">The content is stored as 32-bit little endian words.<a href="#section-3.2.1.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="group-membership-extension">
<section id="section-3.2.1.4">
            <h5 id="name-group-membership-extension">
<a href="#section-3.2.1.4" class="section-number selfRef">3.2.1.4. </a><a href="#name-group-membership-extension" class="section-name selfRef">Group Membership Extension</a>
            </h5>
<p id="section-3.2.1.4-1">The Group Membership handshake extension is used to distinguish single SRT connections
and bonded SRT connections (group connections).<a href="#section-3.2.1.4-1" class="pilcrow">¶</a></p>
<span id="name-group-membership-extension-"></span><div id="fig-hsext-group">
<figure id="figure-10">
              <div class="artwork art-text alignLeft" id="section-3.2.1.4-2.1">
<pre>
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Group ID                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type    |     Flags     |             Weight              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-group-membership-extension-" class="selfRef">Group Membership Extension Message</a>
              </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1.4-3">
              <dt id="section-3.2.1.4-3.1">GroupID (32 bits):</dt>
              <dd id="section-3.2.1.4-3.2">
  The group identifier of a group to which there belongs the socket that is making the connection at the sending side.
The target socket that should interpret it should belong to the corresponding group on its side
(or should create one, if it doesn't exist).<a href="#section-3.2.1.4-3.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.4-3.3">Type (8 bits):</dt>
              <dd id="section-3.2.1.4-3.4">
  Group type, as per SRT_GTYPE_ enumeration.<a href="#section-3.2.1.4-3.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<ul class="normal">
<li class="normal" id="section-3.2.1.4-4.1">0: undefined group type,<a href="#section-3.2.1.4-4.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2.1.4-4.2">1: broadcast group type,<a href="#section-3.2.1.4-4.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2.1.4-4.3">2: main/backup group type<a href="#section-3.2.1.4-4.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2.1.4-4.4">3: balancing group type (reserved for future use)<a href="#section-3.2.1.4-4.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2.1.4-4.5">4: multicast group type (reserved for future use)<a href="#section-3.2.1.4-4.5" class="pilcrow">¶</a>
</li>
            </ul>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1.4-5">
              <dt id="section-3.2.1.4-5.1">Flags (8 bits):</dt>
              <dd id="section-3.2.1.4-5.2">
  Special flags mostly reserved for the future. See <a href="#fig-hsext-group-flags" class="xref">Figure 11</a>.<a href="#section-3.2.1.4-5.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.4-5.3">Weight (16 bits):</dt>
              <dd id="section-3.2.1.4-5.4">
  Special value with interpretation depending on the Type field value.<a href="#section-3.2.1.4-5.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<ul class="normal">
<li class="normal" id="section-3.2.1.4-6.1">Not used in case of broadcast group.<a href="#section-3.2.1.4-6.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2.1.4-6.2">In backup group defines the link priority.<a href="#section-3.2.1.4-6.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2.1.4-6.3">In the rest cases the meaning is not yet defined (reserved for future).<a href="#section-3.2.1.4-6.3" class="pilcrow">¶</a>
</li>
            </ul>
<span id="name-group-membership-extension-f"></span><div id="fig-hsext-group-flags">
<figure id="figure-11">
              <div class="artwork art-text alignLeft" id="section-3.2.1.4-7.1">
<pre>
0 1 2 3 4 5 6 7
+-+-+-+-+-+-+-+
+-+-+-+-+-+-+-+
|   (zero)  |M|
+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-group-membership-extension-f" class="selfRef">Group Membership Extension Flags</a>
              </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1.4-8">
              <dt id="section-3.2.1.4-8.1">M (1 bit):</dt>
              <dd id="section-3.2.1.4-8.2">
  When set, defines synchronization on message numbers, otherwise transmission is synchronized on sequence numbers.<a href="#section-3.2.1.4-8.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="ctrl-pkt-keepalive">
<section id="section-3.2.2">
          <h4 id="name-keep-alive">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-keep-alive" class="section-name selfRef">Keep-Alive</a>
          </h4>
<p id="section-3.2.2-1">Keep-Alive control packets are sent after a certain timeout from the last time
any packet (Control or Data) was sent. The purpose of this control packet is to 
notify the peer to keep the connection open when no data exchange is taking place.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">The default timeout for a Keep-Alive packet to be sent is 1 second.<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2.2-3">An SRT Keep-Alive packet is formatted as follows:<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
<span id="name-keep-alive-structure"></span><div id="keepalive-structure">
<figure id="figure-12">
            <div class="artwork art-text alignLeft" id="section-3.2.2-4.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|         Control Type        |            Reserved           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Type-specific Information                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Time Stamp                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Destination Socket ID                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- CIF -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           CIF (none)                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-keep-alive-structure" class="selfRef">Keep-Alive structure</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.2-5">
            <dt id="section-3.2.2-5.1">Packet Type ( ): 1 bit. Value: 1</dt>
            <dd id="section-3.2.2-5.2">
  The type value of a Keep-Alive control packet is "1".<a href="#section-3.2.2-5.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-5.3">Control Type ( ): 15 bits.  Value: KEEPALIVE{1}</dt>
            <dd id="section-3.2.2-5.4">
  This is a fixed-width field used to indicate message type<a href="#section-3.2.2-5.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-5.5">Reserved ( ): 16 bits.  Value: ???</dt>
            <dd id="section-3.2.2-5.6">
  This is a fixed-width field reserved for future use.<a href="#section-3.2.2-5.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-5.7">Type-specific Information:</dt>
            <dd id="section-3.2.2-5.8">
  This field is reserved for future definition.<a href="#section-3.2.2-5.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-5.9">Time Stamp (TS): 32 bits.  Value: ???</dt>
            <dd id="section-3.2.2-5.10">
  This is a fixed-width field usually containing the time (in microseconds) when a 
 packet was sent, although the real interpretation may vary depending on the type.<a href="#section-3.2.2-5.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-5.11">Destination Socket ID (DestSockID): 32 bits.  Value: ???</dt>
            <dd id="section-3.2.2-5.12">
  This is a fixed-width field providing the socket ID to which a packet should be 
 dispatched, although it may have the special value 0 when the packet is a 
 connection request.<a href="#section-3.2.2-5.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-5.13">Control Information Field (CIF): n bits. Value: {none}</dt>
            <dd id="section-3.2.2-5.14">
  This field must not appear in Keep-Alive control packets.<a href="#section-3.2.2-5.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ctrl-pkt-ack">
<section id="section-3.2.3">
          <h4 id="name-ack-acknowledgment">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-ack-acknowledgment" class="section-name selfRef">ACK (Acknowledgment)</a>
          </h4>
<p id="section-3.2.3-1">Acknowledgment control packets are used to provide delivery status of data packets.
These packets may also carry some additional information from the receiver like
RTT, bandwidth, receiving speed, etc. The CIF portion of the ACK control packet is 
expanded as follows:<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
<span id="name-ack-control-packet"></span><div id="ack-control-packet">
<figure id="figure-13">
            <div class="artwork art-text alignLeft" id="section-3.2.3-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|        Control Type         |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Type-specific Information                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Time Stamp                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Destination Socket ID                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- CIF -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Last Acknowledged Packet Sequence Number           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              RTT                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          RTT variance                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Available Buffer Size                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Packets Receiving Rate                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Estimated Link Capacity                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Receiving Rate                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-ack-control-packet" class="selfRef">ACK control packet</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.3-3">
            <dt id="section-3.2.3-3.1">Type-specific Information (32 bits):</dt>
            <dd id="section-3.2.3-3.2">
  The time-specific Information (<a href="#controlpacket" class="xref">Figure 4</a>) of the ACK packet stores the
sequential number of the full ACK packet starting from 1.<a href="#section-3.2.3-3.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-3.3">Last Acknowledged Packet Sequence Number (32 bits):</dt>
            <dd id="section-3.2.3-3.4">
  The sequence number of the last acknowledged data packet +1.<a href="#section-3.2.3-3.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-3.5">RTT (32 bits):</dt>
            <dd id="section-3.2.3-3.6">
  RTT value (in microseconds) estimated by the receiver based on the previous ACK-ACKACK
packet exchange.<a href="#section-3.2.3-3.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-3.7">RTT variance (32 bits):</dt>
            <dd id="section-3.2.3-3.8">
  The variance of the RTT estimation (in microseconds).<a href="#section-3.2.3-3.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-3.9">Available Buffer Size (32 bits):</dt>
            <dd id="section-3.2.3-3.10">
  Available size of the receiver's buffer (in packets).<a href="#section-3.2.3-3.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-3.11">Packets Receiving Rate (32 bits):</dt>
            <dd id="section-3.2.3-3.12">
  The rate at which packets are being received (in packets per second).<a href="#section-3.2.3-3.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-3.13">Estimated Link Capacity (32 bits):</dt>
            <dd id="section-3.2.3-3.14">
  Estimated bandwidth of the link (in packets per second).<a href="#section-3.2.3-3.14" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-3.15">Receiving Rate (32 bits):</dt>
            <dd id="section-3.2.3-3.16">
  Estimated receiving rate (in bytes per second).<a href="#section-3.2.3-3.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.3-4">There are several types of ACK packets:<a href="#section-3.2.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.3-5.1">A Full ACK control packet is sent every 10 ms and has all the fields 
of <a href="#ack-control-packet" class="xref">Figure 13</a>.<a href="#section-3.2.3-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.3-5.2">A Lite ACK control packet includes only the Last Acknowledged Packet Sequence Number 
field. The Type-specific Information field should be set to 0.<a href="#section-3.2.3-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.3-5.3">A Small ACK includes the fields up to and including the Available Buffer Size field. 
The Type-specific Information field should be set to 0.<a href="#section-3.2.3-5.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.3-6">The sender only acknowledges the receipt of Full ACK packets (see ACKACK Section <a href="#ctrl-pkt-ackack" class="xref">Section 3.2.6</a>).<a href="#section-3.2.3-6" class="pilcrow">¶</a></p>
<p id="section-3.2.3-7">The Lite ACK and Small ACK packets are used in cases when the receiver should acknowledge
received data packets more often than every 10 ms. This is usually needed at high data rates.
It is up to the receiver to decide the condition and the type of ACK packet to send (Lite or Small).
The recommendation is to send a Lite ACK for every 64 packets received.<a href="#section-3.2.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ctrl-pkt-nak">
<section id="section-3.2.4">
          <h4 id="name-nak-loss-report">
<a href="#section-3.2.4" class="section-number selfRef">3.2.4. </a><a href="#name-nak-loss-report" class="section-name selfRef">NAK (Loss Report)</a>
          </h4>
<p id="section-3.2.4-1">Negative acknowledgment (NAK) control packets are used to signal failed data packet 
deliveries. The receiver notifies the sender about lost data packets by sending a NAK 
packet that contains a list of sequence numbers for those lost packets.<a href="#section-3.2.4-1" class="pilcrow">¶</a></p>
<p id="section-3.2.4-2">An SRT NAK packet is formatted as follows:<a href="#section-3.2.4-2" class="pilcrow">¶</a></p>
<span id="name-nak-control-packet"></span><div id="nak-control-packet">
<figure id="figure-14">
            <div class="artwork art-text alignLeft" id="section-3.2.4-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|        Control Type         |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Type-specific Information                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Time Stamp                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Destination Socket ID                     |
+-+-+-+-+-+-+-+-+-+-+-+- CIF (Loss List) -+-+-+-+-+-+-+-+-+-+-+-+
|0|                 Lost packet sequence number                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|                    List of lost packets                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|                            Up to                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|                 Lost packet sequence number                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-nak-control-packet" class="selfRef">NAK control packet</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.4-4">
            <dt id="section-3.2.4-4.1">Control Type:</dt>
            <dd id="section-3.2.4-4.2">
  The type value of a NAK control packet is "3".<a href="#section-3.2.4-4.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.4-4.3">Type-specific Information:</dt>
            <dd id="section-3.2.4-4.4">
  This field is reserved for future definition.<a href="#section-3.2.4-4.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.4-4.5">Control Information Field (CIF):</dt>
            <dd id="section-3.2.4-4.6">
  A single value or a list of lost packets sequence numbers. See packet sequence number 
coding in <a href="#packet-seq-list-coding" class="xref">Appendix A</a>.<a href="#section-3.2.4-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ctrl-pkt-shutdown">
<section id="section-3.2.5">
          <h4 id="name-shutdown">
<a href="#section-3.2.5" class="section-number selfRef">3.2.5. </a><a href="#name-shutdown" class="section-name selfRef">Shutdown</a>
          </h4>
<p id="section-3.2.5-1">Shutdown control packets are used to initiate the closing of an SRT connection.<a href="#section-3.2.5-1" class="pilcrow">¶</a></p>
<p id="section-3.2.5-2">An SRT SHUTDOWN Control packet is formatted as follows:<a href="#section-3.2.5-2" class="pilcrow">¶</a></p>
<span id="name-shutdown-control-packet"></span><div id="shutdown-control-packet">
<figure id="figure-15">
            <div class="artwork art-text alignLeft" id="section-3.2.5-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|        Control Type         |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Type-specific Information                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Time Stamp                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Destination Socket ID                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- CIF -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              None                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-shutdown-control-packet" class="selfRef">SHUTDOWN control packet</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.5-4">
            <dt id="section-3.2.5-4.1">Control Type:</dt>
            <dd id="section-3.2.5-4.2">
  The type value of Shutdown control packet is "5".<a href="#section-3.2.5-4.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.5-4.3">Type-specific Information:</dt>
            <dd id="section-3.2.5-4.4">
  This field is reserved for future definition.<a href="#section-3.2.5-4.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.5-4.5">Control Information Field:</dt>
            <dd id="section-3.2.5-4.6">
  This field must not appear in shutdown control packets.<a href="#section-3.2.5-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ctrl-pkt-ackack">
<section id="section-3.2.6">
          <h4 id="name-ackack">
<a href="#section-3.2.6" class="section-number selfRef">3.2.6. </a><a href="#name-ackack" class="section-name selfRef">ACKACK</a>
          </h4>
<p id="section-3.2.6-1">ACKACK control packets are sent to acknowledge the reception of a Full ACK, and are used 
in the calculation of RTT by the receiver.<a href="#section-3.2.6-1" class="pilcrow">¶</a></p>
<p id="section-3.2.6-2">An SRT ACKACK Control packet is formatted as follows:<a href="#section-3.2.6-2" class="pilcrow">¶</a></p>
<span id="name-ackack-control-packet"></span><div id="ackack-control-packet">
<figure id="figure-16">
            <div class="artwork art-text alignLeft" id="section-3.2.6-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|        Control Type         |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Type-specific Information                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Time Stamp                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Destination Socket ID                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- CIF -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              None                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-ackack-control-packet" class="selfRef">ACKACK control packet</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.6-4">
            <dt id="section-3.2.6-4.1">Control Type:</dt>
            <dd id="section-3.2.6-4.2">
  The type value of ACKACK control packet is "6".<a href="#section-3.2.6-4.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.6-4.3">Type-specific Information:</dt>
            <dd id="section-3.2.6-4.4">
  ACK Sequence Number. This field is used for the sequence number of
the ACK packet being acknowledged.<a href="#section-3.2.6-4.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.6-4.5">Control Information Field:</dt>
            <dd id="section-3.2.6-4.6">
  This field must not appear in ACKACK control packets.<a href="#section-3.2.6-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="srt-data-transmission-and-control">
<section id="section-4">
      <h2 id="name-srt-data-transmission-and-c">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-srt-data-transmission-and-c" class="section-name selfRef">SRT Data Transmission and Control</a>
      </h2>
<p id="section-4-1">This section describes key concepts related to the handling of control
and data packets during the transmission process.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">After the handshake and exchange of capabilities is completed, packet data 
can be sent and received over the established connection. To fully utilize 
the features of low latency and error recovery provided by SRT, the sender 
and receiver MUST handle control packets, timers, and buffers for the connection
as specified in this section.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="stream-multiplexing">
<section id="section-4.1">
        <h3 id="name-stream-multiplexing">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-stream-multiplexing" class="section-name selfRef">Stream Multiplexing</a>
        </h3>
<p id="section-4.1-1">Multiple SRT sockets may share the same UDP socket so that the packets
received to this UDP socket will be correctly dispatched to those
SRT sockets they are currently destined.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">During the handshake, the parties exchange their SRT Socket IDs.
These IDs are then used in the Destination Socket ID field of
every control and data packet (see <a href="#packet-structure" class="xref">Section 3</a>).<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="data-transmission-mode">
<section id="section-4.2">
        <h3 id="name-data-transmission-modes">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-data-transmission-modes" class="section-name selfRef">Data Transmission Modes</a>
        </h3>
<p id="section-4.2-1">SRT has been mainly created for Live Streaming and therefore its main and
default transmission mode is "live". SRT supports, however, the modes that
the original UDT library supported, that is, buffer and message transmission.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div id="transmission-mode-msg">
<section id="section-4.2.1">
          <h4 id="name-message-mode">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-message-mode" class="section-name selfRef">Message Mode</a>
          </h4>
<p id="section-4.2.1-1">When the STREAM flag of the handshake Extension Message
<a href="#handshake-extension-msg" class="xref">Section 3.2.1.1</a> is set to 0, the protocol operates
in Message mode, characterized as follows:<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-2.1">Every packet has its own Packet Sequence Number.<a href="#section-4.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.2.1-2.2">One or several consecutive SRT Data packets can form a message.<a href="#section-4.2.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.2.1-2.3">All the packets belonging to the same message have a similar message number set
    in the Message Number field.<a href="#section-4.2.1-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.1-3">The first packet of a message has the first bit of the Packet Position Flags (<a href="#data-pkt" class="xref">Section 3.1</a>)
set to 1. The last packet of the message has the second bit of the Packet Position Flags
set to 1. Thus, a PP equal to "11b" indicates a packet that forms the whole message.
A PP equal to "00b" indicates a packet that belongs to the inner part of the message.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<p id="section-4.2.1-4">The concept of the message in SRT comes from UDT (<span>[<a href="#GHG04b" class="xref">GHG04b</a>]</span>). In this mode a single 
sending instruction passes exactly one piece of data that has boundaries (a message). 
This message may span across multiple UDP packets (and multiple SRT data packets). The 
only size limitation is that it shall fit as a whole in the buffers of the sender and the 
receiver. Although internally all operations (e.g. ACK, NAK) on data packets are performed 
independently, an application MUST send and receive the whole message. Until the message 
is complete (all packets are received) the application will not be allowed to read it.<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
<p id="section-4.2.1-5">When the Order Flag of a Data packet is set to 1, this imposes a sequential reading order
on messages. An Order Flag set to 0 allows an application to read messages that are 
already fully available, before any preceding messages that may have some packets missing.<a href="#section-4.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="transmission-mode-live">
<section id="section-4.2.2">
          <h4 id="name-live-mode">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-live-mode" class="section-name selfRef">Live Mode</a>
          </h4>
<p id="section-4.2.2-1">Live mode is a special type of message mode where only data packets
with their PP field set to "11b" are allowed.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">Additionally Timestamp Based Packet Delivery (TSBPD) (<a href="#tsbpd" class="xref">Section 4.5</a>) and
Too-Late Packet Drop (<a href="#too-late-packet-drop" class="xref">Section 4.6</a>) mechanisms are used in this mode.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="transmission-mode-buffer">
<section id="section-4.2.3">
          <h4 id="name-buffer-mode">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-buffer-mode" class="section-name selfRef">Buffer Mode</a>
          </h4>
<p id="section-4.2.3-1">Buffer mode is negotiated during the Handshake by setting the STREAM flag
of the handshake Extension Message Flags to 1.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3-2">In this mode consecutive packets form one continuous stream that can be read, with 
portions of any size.<a href="#section-4.2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="handshake-messages">
<section id="section-4.3">
        <h3 id="name-handshake-messages">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-handshake-messages" class="section-name selfRef">Handshake Messages</a>
        </h3>
<p id="section-4.3-1">SRT is a connection-oriented protocol. It embraces the concepts of "connection"
and "session". The UDP system protocol is used by SRT for sending data
and control packets.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">An SRT connection is characterized by the fact that it is:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-3.1">first engaged by a handshake process;<a href="#section-4.3-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-3.2">maintained as long as any packets are being exchanged in a timely manner;<a href="#section-4.3-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-3.3">considered closed when a party receives the appropriate close command from
its peer (connection closed by the foreign host), or when it receives no
packets at all for some predefined time (connection broken on timeout).<a href="#section-4.3-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.3-4">SRT supports two connection configurations:<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3-5">
          <li id="section-4.3-5.1">Caller-Listener, where one side waits for the other to initiate a connection<a href="#section-4.3-5.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-5.2">Rendezvous, where both sides attempt to initiate a connection<a href="#section-4.3-5.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.3-6">The handshake is performed between two parties: "Initiator" and "Responder":<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-7.1">Initiator starts the extended SRT handshake process and sends appropriate
SRT extended handshake requests.<a href="#section-4.3-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-7.2">Responder expects the SRT extended handshake requests to be sent by the
Initiator and sends SRT extended handshake responses back.<a href="#section-4.3-7.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.3-8">There are two basic types of SRT handshake extensions that are exchanged
in the handshake:<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-9.1">Handshake Extension Message exchanges the basic SRT information;<a href="#section-4.3-9.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-9.2">Key Material Exchange exchanges the wrapped stream encryption key (used only if
encryption is requested).<a href="#section-4.3-9.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-9.3">Stream ID extension exchanges some stream-specific information that can be used
by the application to identify the incoming stream connection.<a href="#section-4.3-9.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.3-10">The Initiator and Responder roles are assigned depending on the connection mode.<a href="#section-4.3-10" class="pilcrow">¶</a></p>
<p id="section-4.3-11">For Caller-Listener connections: the Caller is the Initiator,
the Listener is the Responder.
For Rendezvous connections: the Initiator and Responder roles are assigned
based on the initial data interchange during the handshake.<a href="#section-4.3-11" class="pilcrow">¶</a></p>
<p id="section-4.3-12">The Handshake Type field in the Handshake Structure (see <a href="#handshake-packet-structure" class="xref">Figure 5</a>) 
indicates the handshake message type.<a href="#section-4.3-12" class="pilcrow">¶</a></p>
<p id="section-4.3-13">Caller-Listener handshake exchange has the following order of Handshake Types:<a href="#section-4.3-13" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3-14">
          <li id="section-4.3-14.1">Caller to Listener: INDUCTION<a href="#section-4.3-14.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-14.2">Listener to Caller: INDUCTION (reports cookie)<a href="#section-4.3-14.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-14.3">Caller to Listener: CONCLUSION (uses previously returned cookie)<a href="#section-4.3-14.3" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-14.4">Listener to Caller: CONCLUSION (confirms connection established)<a href="#section-4.3-14.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.3-15">Rendezvous handshake exchange has the following order of Handshake Types:<a href="#section-4.3-15" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3-16">
          <li id="section-4.3-16.1">After starting the connection: WAVEAHAND.<a href="#section-4.3-16.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-16.2">After receiving the above message from the peer: CONCLUSION.<a href="#section-4.3-16.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-16.3">After receiving the above message from the peer: AGREEMENT.<a href="#section-4.3-16.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.3-17">When a connection process has failed before either party can send the CONCLUSION handshake, 
the Handshake Type field will contain the appropriate error value for the rejected 
connection. See the list of error codes in <a href="#hs-rej-reason" class="xref">Table 7</a>.<a href="#section-4.3-17" class="pilcrow">¶</a></p>
<span id="name-handshake-rejection-reason-"></span><div id="hs-rej-reason">
<table class="center" id="table-7">
          <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-handshake-rejection-reason-" class="selfRef">Handshake Rejection Reason Codes</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Code</th>
              <th class="text-left" rowspan="1" colspan="1">Error</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1000</td>
              <td class="text-left" rowspan="1" colspan="1">REJ_UNKNOWN</td>
              <td class="text-left" rowspan="1" colspan="1">Unknown reason</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1001</td>
              <td class="text-left" rowspan="1" colspan="1">REJ_SYSTEM</td>
              <td class="text-left" rowspan="1" colspan="1">System function error</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1002</td>
              <td class="text-left" rowspan="1" colspan="1">REJ_PEER</td>
              <td class="text-left" rowspan="1" colspan="1">Rejected by peer</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1003</td>
              <td class="text-left" rowspan="1" colspan="1">REJ_RESOURCE</td>
              <td class="text-left" rowspan="1" colspan="1">Resource allocation problem</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1004</td>
              <td class="text-left" rowspan="1" colspan="1">REJ_ROGUE</td>
              <td class="text-left" rowspan="1" colspan="1">incorrect data in handshake</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1005</td>
              <td class="text-left" rowspan="1" colspan="1">REJ_BACKLOG</td>
              <td class="text-left" rowspan="1" colspan="1">listener's backlog exceeded</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1006</td>
              <td class="text-left" rowspan="1" colspan="1">REJ_IPE</td>
              <td class="text-left" rowspan="1" colspan="1">internal program error</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1007</td>
              <td class="text-left" rowspan="1" colspan="1">REJ_CLOSE</td>
              <td class="text-left" rowspan="1" colspan="1">socket is closing</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1008</td>
              <td class="text-left" rowspan="1" colspan="1">REJ_VERSION</td>
              <td class="text-left" rowspan="1" colspan="1">peer is older version than agent's min</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1009</td>
              <td class="text-left" rowspan="1" colspan="1">REJ_RDVCOOKIE</td>
              <td class="text-left" rowspan="1" colspan="1">rendezvous cookie collision</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1010</td>
              <td class="text-left" rowspan="1" colspan="1">REJ_BADSECRET</td>
              <td class="text-left" rowspan="1" colspan="1">wrong password</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1011</td>
              <td class="text-left" rowspan="1" colspan="1">REJ_UNSECURE</td>
              <td class="text-left" rowspan="1" colspan="1">password required or unexpected</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1012</td>
              <td class="text-left" rowspan="1" colspan="1">REJ_MESSAGEAPI</td>
              <td class="text-left" rowspan="1" colspan="1">Stream flag collision</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1013</td>
              <td class="text-left" rowspan="1" colspan="1">REJ_CONGESTION</td>
              <td class="text-left" rowspan="1" colspan="1">incompatible congestion-controller type</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1014</td>
              <td class="text-left" rowspan="1" colspan="1">REJ_FILTER</td>
              <td class="text-left" rowspan="1" colspan="1">incompatible packet filter</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1015</td>
              <td class="text-left" rowspan="1" colspan="1">REJ_GROUP</td>
              <td class="text-left" rowspan="1" colspan="1">incompatible group</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-4.3-19">The specification of the cipher family and block size is decided by the data Sender.
When the transmission is bidirectional, this value must be agreed upon at the outset
because when both are set the Responder wins. For Caller-Listener connections it is
reasonable to set this value on the Listener only. In the case of Rendezvous the only
reasonable approach is to decide upon the correct value from the different sources and to 
set it on both parties (note that <strong>AES-128</strong> is the default).<a href="#section-4.3-19" class="pilcrow">¶</a></p>
<div id="caller-listener-handshake">
<section id="section-4.3.1">
          <h4 id="name-caller-listener-handshake">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-caller-listener-handshake" class="section-name selfRef">Caller-Listener Handshake</a>
          </h4>
<p id="section-4.3.1-1">This section describes the handshaking process where a Listener is
waiting for an incoming Handshake request on a bound UDP port from a Caller.
The process has two phases: induction and conclusion.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<div id="the-induction-phase">
<section id="section-4.3.1.1">
            <h5 id="name-the-induction-phase">
<a href="#section-4.3.1.1" class="section-number selfRef">4.3.1.1. </a><a href="#name-the-induction-phase" class="section-name selfRef">The Induction Phase</a>
            </h5>
<p id="section-4.3.1.1-1">The INDUCTION phase serves only to set a cookie on the Listener so that it
doesn't allocate resources, thus mitigating a potential DoS attack that might be
perpetrated by flooding the Listener with handshake commands.<a href="#section-4.3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1.1-2">The Caller begins by sending the INDUCTION handshake, which contains the following
(significant) fields:<a href="#section-4.3.1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1.1-3.1">Version: must always be 4<a href="#section-4.3.1.1-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.1.1-3.2">Encryption Field: 0<a href="#section-4.3.1.1-3.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.1.1-3.3">Extension Field: 2<a href="#section-4.3.1.1-3.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.1.1-3.4">Handshake Type: INDUCTION<a href="#section-4.3.1.1-3.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.1.1-3.5">SRT Socket ID: SRT Socket ID of the Caller<a href="#section-4.3.1.1-3.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.1.1-3.6">SYN Cookie: 0<a href="#section-4.3.1.1-3.6" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.3.1.1-4">The Destination Socket ID of the SRT packet header in this message is 0, which is
interpreted as a connection request.<a href="#section-4.3.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.3.1.1-5">The handshake version number is set to 4 in this initial handshake.
This is due to the initial design of SRT that was to be compliant with the UDT
protocol (<span>[<a href="#GHG04b" class="xref">GHG04b</a>]</span>) on which it is based.<a href="#section-4.3.1.1-5" class="pilcrow">¶</a></p>
<p id="section-4.3.1.1-6">The Listener responds with the following:<a href="#section-4.3.1.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1.1-7.1">Version: 5<a href="#section-4.3.1.1-7.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.1.1-7.2">Encryption Field: Advertised cipher family and block size.<a href="#section-4.3.1.1-7.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.1.1-7.3">Extension Field: SRT magic code 0x4A17<a href="#section-4.3.1.1-7.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.1.1-7.4">Handshake Type: INDUCTION<a href="#section-4.3.1.1-7.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.1.1-7.5">SRT Socket ID: Socket ID of the Listener<a href="#section-4.3.1.1-7.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.1.1-7.6">SYN Cookie: a cookie that is crafted based on host, port and current time
with 1 minute accuracy to avoid SYN flooding attack <span>[<a href="#RFC4987" class="xref">RFC4987</a>]</span><a href="#section-4.3.1.1-7.6" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.3.1.1-8">At this point the Listener still does not know if the Caller is SRT or UDT,
and it responds with the same set of values regardless of whether the Caller is
SRT or UDT.<a href="#section-4.3.1.1-8" class="pilcrow">¶</a></p>
<p id="section-4.3.1.1-9">If the party is SRT, it does interpret the values in Version and Extension Field.
If it receives the value 5 in Version, it understands that it comes from an SRT
party, so it knows that it should prepare the proper handshake messages
phase. It also checks the following:<a href="#section-4.3.1.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1.1-10.1">whether the Extension Flags contains the magic value 0x4A17; otherwise the
connection is rejected. This is a contingency for the case where someone who,
in an attempt to extend UDT independently, increases the Version value to 5
and tries to test it against SRT.<a href="#section-4.3.1.1-10.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.1.1-10.2">whether the Encryption Flags contain a non-zero
value, which is interpreted as an advertised cipher family and block size.<a href="#section-4.3.1.1-10.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.3.1.1-11">A legacy UDT party completely ignores the values reported in Version and Handshake Type. 
It is, however, interested in the SYN Cookie value, as this must be passed to the next 
phase. It does interpret these fields, but only in the "conclusion" message.<a href="#section-4.3.1.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-conclusion-phase">
<section id="section-4.3.1.2">
            <h5 id="name-the-conclusion-phase">
<a href="#section-4.3.1.2" class="section-number selfRef">4.3.1.2. </a><a href="#name-the-conclusion-phase" class="section-name selfRef">The Conclusion Phase</a>
            </h5>
<p id="section-4.3.1.2-1">Once the Caller gets the SYN cookie from the Listener, it sends the CONCLUSION handshake
to the Listener.<a href="#section-4.3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1.2-2">The following values are set by the compliant caller:<a href="#section-4.3.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1.2-3.1">Version: 5<a href="#section-4.3.1.2-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.1.2-3.2">Handshake Type: CONCLUSION<a href="#section-4.3.1.2-3.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.1.2-3.3">SRT Socket ID: Socket ID of the Caller<a href="#section-4.3.1.2-3.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.1.2-3.4">SYN Cookie: the cookie previously received in the induction phase<a href="#section-4.3.1.2-3.4" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.3.1.2-4">The Destination Socket ID in this message is the
socket ID that was previously received in the induction phase in the SRT Socket ID field
of the handshake structure.<a href="#section-4.3.1.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1.2-5.1">Encryption Flags: advertised cipher family and block size.<a href="#section-4.3.1.2-5.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.1.2-5.2">Extension Flags: A set of flags that define the extensions provided in the handshake.<a href="#section-4.3.1.2-5.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.3.1.2-6">The Listener responds with the same values shown above, without the cookie (which
is not needed here), as well as the extensions for HS Version 5 (which will probably be
exactly the same).<a href="#section-4.3.1.2-6" class="pilcrow">¶</a></p>
<p id="section-4.3.1.2-7">There is not any "negotiation" here. If the values passed in the
handshake are in any way not acceptable by the other side, the connection will
be rejected. The only case when the Listener can have precedence over the Caller
is the advertised Cipher Family and Block Size (<a href="#handshake-encr-fld" class="xref">Table 2</a>)
in the Encryption Field of the Handshake.<a href="#section-4.3.1.2-7" class="pilcrow">¶</a></p>
<p id="section-4.3.1.2-8">The value for latency is always agreed to be the greater of those reported
by each party.<a href="#section-4.3.1.2-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="rendezvous-handshake">
<section id="section-4.3.2">
          <h4 id="name-rendezvous-handshake">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-rendezvous-handshake" class="section-name selfRef">Rendezvous Handshake</a>
          </h4>
<p id="section-4.3.2-1">The Rendezvous process uses a state machine. It is slightly
different from UDT Rendezvous handshake <span>[<a href="#GHG04b" class="xref">GHG04b</a>]</span>,
although it is still based on the same message request types.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2-2">Both parties start with WAVEAHAND and use the Version value of 5.
Legacy Version 4 clients do not look at the Version value,
whereas Version 5 clients can detect version 5.
The parties only continue with the Version 5 Rendezvous process when Version is set to 5
for both. Otherwise the process continues exclusively according to Version 4 rules <span>[<a href="#GHG04b" class="xref">GHG04b</a>]</span>.<a href="#section-4.3.2-2" class="pilcrow">¶</a></p>
<p id="section-4.3.2-3">With Version 5 Rendezvous, both parties create a cookie for a process called the
"cookie contest". This is necessary for the assignment of Initiator and Responder
roles. Each party generates a cookie value (a 32-bit number) based on the host,
port, and current time with 1 minute accuracy. This value is scrambled using
an MD5 sum calculation. The cookie values are then compared with one another.<a href="#section-4.3.2-3" class="pilcrow">¶</a></p>
<p id="section-4.3.2-4">Since it is impossible to have two sockets on the same machine bound to the same NIC
and port and operating independently, it is virtually impossible that the
parties will generate identical cookies. However, this situation may occur if an
application tries to "connect to itself" - that is, either connects to a local
IP address, when the socket is bound to INADDR_ANY, or to the same IP address to
which the socket was bound. If the cookies are identical (for any reason), the
connection will not be made until new, unique cookies are generated (after a
delay of up to one minute). In the case of an application "connecting to itself",
the cookies will always be identical, and so the connection will never be established.<a href="#section-4.3.2-4" class="pilcrow">¶</a></p>
<p id="section-4.3.2-5">When one party's cookie value is greater than its peer's, it wins the cookie
contest and becomes Initiator (the other party becomes the Responder).<a href="#section-4.3.2-5" class="pilcrow">¶</a></p>
<p id="section-4.3.2-6">At this point there are two possible "handshake flows":
serial and parallel.<a href="#section-4.3.2-6" class="pilcrow">¶</a></p>
<div id="serial-handshake-flow">
<section id="section-4.3.2.1">
            <h5 id="name-serial-handshake-flow">
<a href="#section-4.3.2.1" class="section-number selfRef">4.3.2.1. </a><a href="#name-serial-handshake-flow" class="section-name selfRef">Serial Handshake Flow</a>
            </h5>
<p id="section-4.3.2.1-1">In the serial handshake flow, one party is always first, and the other follows.
That is, while both parties are repeatedly sending WAVEAHAND messages, at
some point one party - let's say Alice - will find she has received a
WAVEAHAND message before she can send her next one, so she sends a
CONCLUSION message in response. Meantime, Bob (Alice's peer) has missed
Alice's WAVEAHAND messages, so that Alice's CONCLUSION is the first message
Bob has received from her.<a href="#section-4.3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2.1-2">This process can be described easily as a series of exchanges between the first
and following parties (Alice and Bob, respectively):<a href="#section-4.3.2.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2.1-3">
              <li id="section-4.3.2.1-3.1">
                <p id="section-4.3.2.1-3.1.1">Initially, both parties are in the waving state. Alice sends a handshake
message to Bob:<a href="#section-4.3.2.1-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.1-3.1.2.1">Version: 5<a href="#section-4.3.2.1-3.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-4.3.2.1-3.1.2.2">Type: Extension field: 0, Encryption field: advertised "PBKEYLEN".<a href="#section-4.3.2.1-3.1.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-4.3.2.1-3.1.2.3">Handshake Type: WAVEAHAND<a href="#section-4.3.2.1-3.1.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-4.3.2.1-3.1.2.4">SRT Socket ID: Alice's socket ID<a href="#section-4.3.2.1-3.1.2.4" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-4.3.2.1-3.1.2.5">SYN Cookie: Created based on host/port and current time.<a href="#section-4.3.2.1-3.1.2.5" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ol>
<p id="section-4.3.2.1-4">While Alice does not yet know if she is sending this message to
a Version 4 or Version 5 peer, the values from these fields would not be interpreted by
the Version 4 peer when the Handshake Type is WAVEAHAND.<a href="#section-4.3.2.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2.1-5">
              <li id="section-4.3.2.1-5.1">Bob receives Alice's WAVEAHAND message, switches to the "attention"
state. Since Bob now knows Alice's cookie, he performs a "cookie contest"
(compares both cookie values). If Bob's cookie is greater than Alice's, he will
become the Initiator. Otherwise, he will become the Responder.<a href="#section-4.3.2.1-5.1" class="pilcrow">¶</a>
</li>
            </ol>
<p id="section-4.3.2.1-6">The resolution of the Handshake Role
(Initiator or Responder) is essential for further processing.<a href="#section-4.3.2.1-6" class="pilcrow">¶</a></p>
<p id="section-4.3.2.1-7">Then Bob responds:<a href="#section-4.3.2.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.1-8.1">Version: 5<a href="#section-4.3.2.1-8.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.2.1-8.2">Extension field: appropriate flags if Initiator, otherwise 0<a href="#section-4.3.2.1-8.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.2.1-8.3">Encryption field: advertised PBKEYLEN<a href="#section-4.3.2.1-8.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.2.1-8.4">Handshake Type: CONCLUSION<a href="#section-4.3.2.1-8.4" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.3.2.1-9">If Bob is the Initiator and encryption is on, he will use either his
own cipher family and block size or the one received from Alice (if she has advertised
those values).<a href="#section-4.3.2.1-9" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2.1-10">
              <li id="section-4.3.2.1-10.1">
                <p id="section-4.3.2.1-10.1.1">Alice receives Bob's CONCLUSION message. While at this point she also
performs the "cookie contest", the outcome will be the same. She switches to the
"fine" state, and sends:<a href="#section-4.3.2.1-10.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.1-10.1.2.1">Version: 5<a href="#section-4.3.2.1-10.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-4.3.2.1-10.1.2.2">Appropriate extension flags and encryption flags<a href="#section-4.3.2.1-10.1.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-4.3.2.1-10.1.2.3">Handshake Type: CONCLUSION<a href="#section-4.3.2.1-10.1.2.3" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ol>
<p id="section-4.3.2.1-11">Both parties always send extension flags at this point, which will
contain HSREQ if the message comes from an Initiator, or
HSRSP if it comes from a Responder. If the Initiator has received a
previous message from the Responder containing an advertised cipher family and block size in the
encryption flags field, it will be used as the key length
for key generation sent next in the KMREQ extension.<a href="#section-4.3.2.1-11" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2.1-12">
              <li id="section-4.3.2.1-12.1">
                <p id="section-4.3.2.1-12.1.1">Bob receives Alice's CONCLUSION message, and then does one of the
following (depending on Bob's role):<a href="#section-4.3.2.1-12.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.1-12.1.2.1">
                    <p id="section-4.3.2.1-12.1.2.1.1">If Bob is the Initiator (Alice's message contains HSRSP), he:<a href="#section-4.3.2.1-12.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.1-12.1.2.1.2.1">switches to the "connected" state<a href="#section-4.3.2.1-12.1.2.1.2.1" class="pilcrow">¶</a>
</li>
                      <li class="normal" id="section-4.3.2.1-12.1.2.1.2.2">sends Alice a message with Handshake Type AGREEMENT, but containing
no SRT extensions (Extension Flags field should be 0)<a href="#section-4.3.2.1-12.1.2.1.2.2" class="pilcrow">¶</a>
</li>
                    </ul>
</li>
                  <li class="normal" id="section-4.3.2.1-12.1.2.2">
                    <p id="section-4.3.2.1-12.1.2.2.1">If Bob is the Responder (Alice's message contains HSREQ), he:<a href="#section-4.3.2.1-12.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.1-12.1.2.2.2.1">switches to "initiated" state<a href="#section-4.3.2.1-12.1.2.2.2.1" class="pilcrow">¶</a>
</li>
                      <li class="normal" id="section-4.3.2.1-12.1.2.2.2.2">
                        <p id="section-4.3.2.1-12.1.2.2.2.2.1">sends Alice a message with Handshake Type CONCLUSION that also contains
extensions with HSRSP<a href="#section-4.3.2.1-12.1.2.2.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.1-12.1.2.2.2.2.2.1">awaits a confirmation from Alice that she is also connected (preferably
by AGREEMENT message)<a href="#section-4.3.2.1-12.1.2.2.2.2.2.1" class="pilcrow">¶</a>
</li>
                        </ul>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li id="section-4.3.2.1-12.2">
                <p id="section-4.3.2.1-12.2.1">Alice receives the above message, enters into the "connected" state, and
then does one of the following (depending on Alice's role):<a href="#section-4.3.2.1-12.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.1-12.2.2.1">If Alice is the Initiator (received CONCLUSION with HSRSP),
she sends Bob a message with Handshake Type = AGREEMENT.<a href="#section-4.3.2.1-12.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-4.3.2.1-12.2.2.2">If Alice is the Responder, the received message has Handshake Type AGREEMENT
and in response she does nothing.<a href="#section-4.3.2.1-12.2.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li id="section-4.3.2.1-12.3">At this point, if Bob was Initiator, he is connected already. If he was a
Responder, he should receive the above AGREEMENT message, after which he
switches to the "connected" state. In the case where the UDP packet with the
agreement message gets lost, Bob will still enter the "connected" state once
he receives anything else from Alice. If Bob is going to send, however, he
has to continue sending the same CONCLUSION until he gets the confirmation
from Alice.<a href="#section-4.3.2.1-12.3" class="pilcrow">¶</a>
</li>
            </ol>
</section>
</div>
<div id="parallel-handshake-flow">
<section id="section-4.3.2.2">
            <h5 id="name-parallel-handshake-flow">
<a href="#section-4.3.2.2" class="section-number selfRef">4.3.2.2. </a><a href="#name-parallel-handshake-flow" class="section-name selfRef">Parallel Handshake Flow</a>
            </h5>
<p id="section-4.3.2.2-1">The chances of the parallel handshake flow are very low, but still it may
occur if the handshake messages with WAVEAHAND are sent and received by both peers
at precisely the same time.<a href="#section-4.3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2.2-2">The resulting flow is very much like Bob's behavior in the serial handshake flow,
but for both parties. Alice and Bob will go through the same state transitions:<a href="#section-4.3.2.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3.2.2-3">
<pre>
Waving -&gt; Attention -&gt; Initiated -&gt; Connected
</pre><a href="#section-4.3.2.2-3" class="pilcrow">¶</a>
</div>
<p id="section-4.3.2.2-4">In the Attention state they know each other's cookies, so they can assign
roles. In contrast to serial flows,
which are mostly based on request-response cycles, here everything
happens completely asynchronously: the state switches upon reception
of a particular handshake message with appropriate contents (the
Initiator must attach the HSREQ extension, and Responder must attach the
<code>HSRSP</code> extension).<a href="#section-4.3.2.2-4" class="pilcrow">¶</a></p>
<p id="section-4.3.2.2-5">Here's how the parallel handshake flow works, based on roles:<a href="#section-4.3.2.2-5" class="pilcrow">¶</a></p>
<p id="section-4.3.2.2-6">Initiator:<a href="#section-4.3.2.2-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2.2-7">
              <li id="section-4.3.2.2-7.1">
                <p id="section-4.3.2.2-7.1.1">Waving<a href="#section-4.3.2.2-7.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-7.1.2.1">Receives WAVEAHAND message<a href="#section-4.3.2.2-7.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-4.3.2.2-7.1.2.2">Switches to Attention<a href="#section-4.3.2.2-7.1.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-4.3.2.2-7.1.2.3">Sends CONCLUSION + HSREQ<a href="#section-4.3.2.2-7.1.2.3" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li id="section-4.3.2.2-7.2">
                <p id="section-4.3.2.2-7.2.1">Attention<a href="#section-4.3.2.2-7.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-7.2.2.1">
                    <p id="section-4.3.2.2-7.2.2.1.1">Receives CONCLUSION message, which:<a href="#section-4.3.2.2-7.2.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-7.2.2.1.2.1">
                        <p id="section-4.3.2.2-7.2.2.1.2.1.1">contains no extensions:<a href="#section-4.3.2.2-7.2.2.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-7.2.2.1.2.1.2.1">switches to Initiated, still sends CONCLUSION + HSREQ<a href="#section-4.3.2.2-7.2.2.1.2.1.2.1" class="pilcrow">¶</a>
</li>
                        </ul>
</li>
                      <li class="normal" id="section-4.3.2.2-7.2.2.1.2.2">
                        <p id="section-4.3.2.2-7.2.2.1.2.2.1">contains <code>HSRSP</code> extension:<a href="#section-4.3.2.2-7.2.2.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-7.2.2.1.2.2.2.1">switches to Connected, sends AGREEMENT<a href="#section-4.3.2.2-7.2.2.1.2.2.2.1" class="pilcrow">¶</a>
</li>
                        </ul>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li id="section-4.3.2.2-7.3">
                <p id="section-4.3.2.2-7.3.1">Initiated<a href="#section-4.3.2.2-7.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-7.3.2.1">
                    <p id="section-4.3.2.2-7.3.2.1.1">Receives CONCLUSION message, which:<a href="#section-4.3.2.2-7.3.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-7.3.2.1.2.1">
                        <p id="section-4.3.2.2-7.3.2.1.2.1.1">Contains no extensions:<a href="#section-4.3.2.2-7.3.2.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-7.3.2.1.2.1.2.1">REMAINS IN THIS STATE, still sends CONCLUSION + HSREQ<a href="#section-4.3.2.2-7.3.2.1.2.1.2.1" class="pilcrow">¶</a>
</li>
                        </ul>
</li>
                      <li class="normal" id="section-4.3.2.2-7.3.2.1.2.2">
                        <p id="section-4.3.2.2-7.3.2.1.2.2.1">contains <code>HSRSP</code> extension:<a href="#section-4.3.2.2-7.3.2.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-7.3.2.1.2.2.2.1">switches to Connected, sends AGREEMENT<a href="#section-4.3.2.2-7.3.2.1.2.2.2.1" class="pilcrow">¶</a>
</li>
                        </ul>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li id="section-4.3.2.2-7.4">
                <p id="section-4.3.2.2-7.4.1">Connected<a href="#section-4.3.2.2-7.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-7.4.2.1">May receive CONCLUSION and respond with AGREEMENT, but normally
by now it should already have received payload packets.<a href="#section-4.3.2.2-7.4.2.1" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ol>
<p id="section-4.3.2.2-8">Responder:<a href="#section-4.3.2.2-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2.2-9">
              <li id="section-4.3.2.2-9.1">
                <p id="section-4.3.2.2-9.1.1">Waving<a href="#section-4.3.2.2-9.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-9.1.2.1">Receives WAVEAHAND message<a href="#section-4.3.2.2-9.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-4.3.2.2-9.1.2.2">Switches to Attention<a href="#section-4.3.2.2-9.1.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-4.3.2.2-9.1.2.3">Sends CONCLUSION message (with no extensions)<a href="#section-4.3.2.2-9.1.2.3" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li id="section-4.3.2.2-9.2">
                <p id="section-4.3.2.2-9.2.1">Attention<a href="#section-4.3.2.2-9.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-9.2.2.1">Receives CONCLUSION message with HSREQ.
This message might contain no extensions, in which case the party 
shall simply send the empty CONCLUSION message, as before, and remain 
in this state.<a href="#section-4.3.2.2-9.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-4.3.2.2-9.2.2.2">Switches to Initiated and sends CONCLUSION message with HSRSP<a href="#section-4.3.2.2-9.2.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li id="section-4.3.2.2-9.3">
                <p id="section-4.3.2.2-9.3.1">Initiated<a href="#section-4.3.2.2-9.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-9.3.2.1">
                    <p id="section-4.3.2.2-9.3.2.1.1">Receives:<a href="#section-4.3.2.2-9.3.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-9.3.2.1.2.1">
                        <p id="section-4.3.2.2-9.3.2.1.2.1.1">CONCLUSION message with HSREQ<a href="#section-4.3.2.2-9.3.2.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-9.3.2.1.2.1.2.1">responds with CONCLUSION with HSRSP and remains in this state<a href="#section-4.3.2.2-9.3.2.1.2.1.2.1" class="pilcrow">¶</a>
</li>
                        </ul>
</li>
                      <li class="normal" id="section-4.3.2.2-9.3.2.1.2.2">
                        <p id="section-4.3.2.2-9.3.2.1.2.2.1">AGREEMENT message<a href="#section-4.3.2.2-9.3.2.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-9.3.2.1.2.2.2.1">responds with AGREEMENT and switches to Connected<a href="#section-4.3.2.2-9.3.2.1.2.2.2.1" class="pilcrow">¶</a>
</li>
                        </ul>
</li>
                      <li class="normal" id="section-4.3.2.2-9.3.2.1.2.3">
                        <p id="section-4.3.2.2-9.3.2.1.2.3.1">Payload packet<a href="#section-4.3.2.2-9.3.2.1.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-9.3.2.1.2.3.2.1">responds with AGREEMENT and switches to Connected<a href="#section-4.3.2.2-9.3.2.1.2.3.2.1" class="pilcrow">¶</a>
</li>
                        </ul>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li id="section-4.3.2.2-9.4">
                <p id="section-4.3.2.2-9.4.1">Connected<a href="#section-4.3.2.2-9.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-9.4.2.1">Is not expecting to receive any handshake messages anymore. The
AGREEMENT message is always sent only once or per every final
CONCLUSION message.<a href="#section-4.3.2.2-9.4.2.1" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ol>
<p id="section-4.3.2.2-10">Note that any of these packets may be missing, and the sending party will
never become aware. The missing packet problem is resolved this way:<a href="#section-4.3.2.2-10" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2.2-11">
              <li id="section-4.3.2.2-11.1">If the Responder misses the CONCLUSION + HSREQ message, it simply
continues sending empty CONCLUSION messages. Only upon reception of
CONCLUSION + HSREQ does it respond with CONCLUSION + HSRSP.<a href="#section-4.3.2.2-11.1" class="pilcrow">¶</a>
</li>
              <li id="section-4.3.2.2-11.2">If the Initiator misses the CONCLUSION + HSRSP response from the
Responder, it continues sending CONCLUSION + HSREQ. The Responder must
always respond with CONCLUSION + HSRSP when the Initiator sends
CONCLUSION + HSREQ, even if it has already received and interpreted it.<a href="#section-4.3.2.2-11.2" class="pilcrow">¶</a>
</li>
              <li id="section-4.3.2.2-11.3">When the Initiator switches to the Connected state it responds with a
AGREEMENT message, which may be missed by the Responder. Nonetheless, the
Initiator may start sending data packets because it considers itself
connected - it does not know that the Responder has not yet switched
to the Connected state. Therefore it is exceptionally allowed that when
the Responder is in the Initiated state and receives a data packet
(or any control packet that is normally sent only between connected
parties) over this connection, it may switch to the Connected
state just as if it had received a AGREEMENT message.<a href="#section-4.3.2.2-11.3" class="pilcrow">¶</a>
</li>
              <li id="section-4.3.2.2-11.4">If the the Initiator has already switched to the Connected state it will not
bother the Responder with any more handshake messages. But the Responder may be
completely unaware of that (having missed the AGREEMENT message from the
Initiator). Therefore it does not exit the connecting state, which means that it
continues sending CONCLUSION + HSRSP messages until it receives any
packet that will make it switch to the Connected state (normally
AGREEMENT). Only then does it exit the connecting state and the
application can start transmission.<a href="#section-4.3.2.2-11.4" class="pilcrow">¶</a>
</li>
            </ol>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="srt-latency">
<section id="section-4.4">
        <h3 id="name-srt-buffer-latency">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-srt-buffer-latency" class="section-name selfRef">SRT Buffer Latency</a>
        </h3>
<p id="section-4.4-1">The SRT sender and receiver have buffers to store packets.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">On the sender, latency is the time that SRT holds a packet to give it a chance to be
delivered successfully while maintaining the rate of the sender at the receiver. If an 
acknowledgment (ACK) is missing or late for more than the configured latency, the packet 
is dropped from the sender buffer. A packet can be retransmitted as long as it remains
in the buffer for the duration of the latency window. On the receiver, packets are 
delivered to an application from a buffer after the latency interval has passed. This 
helps to recover from potential packet losses. See sections <a href="#tsbpd" class="xref">Section 4.5</a>, 
<a href="#too-late-packet-drop" class="xref">Section 4.6</a> for details.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">Latency is a value (specified in milliseconds) that can cover the time to transmit 
hundreds or even thousands of packets at high bitrate. Latency can be thought of as a 
window that slides over time, during which a number of activities take place, such as 
the reporting of acknowledged packets (ACKs) (<a href="#packet-acks" class="xref">Section 4.8.1</a>) and unacknowledged 
packets (NAKs)(<a href="#packet-naks" class="xref">Section 4.8.2</a>).<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">Latency is configured through the exchange of capabilities during the extended handshake 
process between initiator and responder. The Handshake Extension Message (<a href="#handshake-extension-msg" class="xref">Section 3.2.1.1</a>) 
has TSBPD delay information (in milliseconds) from the SRT receiver and sender. The 
latency for a connection will be established as the maximum value of latencies proposed 
by the initiator and responder.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tsbpd">
<section id="section-4.5">
        <h3 id="name-timestamp-based-packet-deli">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-timestamp-based-packet-deli" class="section-name selfRef">Timestamp Based Packet Delivery</a>
        </h3>
<p id="section-4.5-1">The goal of the SRT Timestamp Based Packet Delivery (TSBPD) mechanism is to reproduce 
the output of the sending application (e.g., encoder) at the input of the receiving 
application (e.g., decoder) in live data transmission mode (see <a href="#data-transmission-mode" class="xref">Section 4.2</a>). 
It attempts to reproduce the timing of packets committed by the sending application to 
the SRT sender. This allows packets to be scheduled for delivery by the SRT receiver, 
making them ready to be read by the receiving application (see <a href="#fig-latency-points" class="xref">Figure 17</a>).<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">The SRT receiver, using the timestamp of the SRT data packet header, delivers packets to 
a receiving application with a fixed minimum delay from the time the packet was scheduled 
for sending on the SRT sender side. Basically, the sender timestamp in the received packet
is adjusted to the receiver's local time (compensating for the time drift or different 
time zones) before releasing the packet to the application. Packets can be withheld by 
the SRT receiver for a configured receiver delay. A higher delay can accommodate a larger 
uniform packet drop rate, or a larger packet burst drop. Packets received after their 
"play time" are dropped if the Too-Late Packet Drop feature is enabled 
(see <a href="#too-late-packet-drop" class="xref">Section 4.6</a>).<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">The packet timestamp (in microseconds) is relative to the SRT connection creation time. 
Packets are inserted based on the sequence number in the header field. The origin time 
(in microseconds) of the packet is already sampled when a packet is first submitted by 
the application to the SRT sender. The TSBPD feature uses this time to stamp the packet 
for first transmission and any subsequent retransmission. This timestamp and the 
configured SRT latency (<a href="#srt-latency" class="xref">Section 4.4</a>) control the recovery buffer size and the 
instant that packets are delivered at the destination (the aforementioned "play time" 
which is decided by adding the timestamp to the configured latency).<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">It is worth mentioning that the use of the packet sending time to stamp the packets is
inappropriate for the TSBPD feature, since a new time (current sending time) is used for 
retransmitted packets, putting them out of order when inserted at their proper place 
in the stream.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<p id="section-4.5-5"><a href="#fig-latency-points" class="xref">Figure 17</a> illustrates the key latency points during the packet transmission 
with the TSBPD feature enabled.<a href="#section-4.5-5" class="pilcrow">¶</a></p>
<span id="name-key-latency-points-during-t"></span><div id="fig-latency-points">
<figure id="figure-17">
          <div class="artwork art-text alignLeft" id="section-4.5-6.1">
<pre>
              |  Sending  |              |                   |
              |   Delay   |    ~RTT/2    |    SRT Latency    |
              |&lt;---------&gt;|&lt;------------&gt;|&lt;-----------------&gt;|
              |           |              |                   |
              |           |              |                   |
              |           |              |                   |
    ___ Scheduled       Sent         Received           Scheduled
   /    for sending       |              |              for delivery
Packet        |           |              |                   |
State         |           |              |                   |
              |           |              |                   |
              |           |              |                   |
              -----------------------------------------------------&gt;
                                                                Time
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-key-latency-points-during-t" class="selfRef">Key Latency Points during the Packet Transmission</a>
          </figcaption></figure>
</div>
<p id="section-4.5-7">The main packet states shown in <a href="#fig-latency-points" class="xref">Figure 17</a> are the following:<a href="#section-4.5-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-8.1">"Scheduled for sending": the packet is committed by the sending application, stamped and ready to be sent;<a href="#section-4.5-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-8.2">"Sent": the packet is passed to the UDP socket and sent;<a href="#section-4.5-8.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-8.3">"Received": the packet is received and read from the UDP socket;<a href="#section-4.5-8.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-8.4">"Scheduled for delivery": the packet is scheduled for the delivery
and ready to be read by the receiving application.<a href="#section-4.5-8.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.5-9">It is worth noting that the round-trip time (RTT) of an SRT link may
vary in time. However the actual end-to-end latency on the link becomes
fixed and is approximately equal to (RTT_0/2 + SRT Latency) once the SRT handshake exchange happens,
where RTT_0 is the actual value of the round-trip time during the SRT handshake
exchange (the value of the round-trip time once the SRT connection has been established).<a href="#section-4.5-9" class="pilcrow">¶</a></p>
<p id="section-4.5-10">The value of sending delay depends on the hardware performance. Usually
it is relatively small (several microseconds) in contrast to RTT_0/2
and SRT latency which are measured in milliseconds.<a href="#section-4.5-10" class="pilcrow">¶</a></p>
<div id="packet-delivery-time">
<section id="section-4.5.1">
          <h4 id="name-packet-delivery-time">
<a href="#section-4.5.1" class="section-number selfRef">4.5.1. </a><a href="#name-packet-delivery-time" class="section-name selfRef">Packet Delivery Time</a>
          </h4>
<p id="section-4.5.1-1">Packet delivery time is the moment, estimated by the receiver, when a packet should be delivered
to the upstream application. The calculation of packet delivery time (PktTsbpdTime) is performed
upon receiving a data packet according to the following formula:<a href="#section-4.5.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.5.1-2">
<pre>
PktTsbpdTime = TsbpdTimeBase + PKT_TIMESTAMP + TsbpdDelay + Drift
</pre><a href="#section-4.5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.5.1-3">where<a href="#section-4.5.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5.1-4.1">TsbpdTimeBase is the time base that reflects the time difference between local clock of the receiver
and the clock used by the sender to timestamp packets being sent (see <a href="#tsbpd-time-base" class="xref">Section 4.5.1.1</a>);<a href="#section-4.5.1-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.5.1-4.2">PKT_TIMESTAMP is the data packet timestamp, in microseconds;<a href="#section-4.5.1-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.5.1-4.3">TsbpdDelay is the receiver's buffer delay (or receiver's buffer latency, or SRT Latency).
This is the time, in milliseconds, that SRT holds a packet from the moment it has been received till the time it
should be delivered to the upstream application;<a href="#section-4.5.1-4.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.5.1-4.4">Drift is the time drift used to adjust the fluctuations between sender and receiver clock, in microseconds.<a href="#section-4.5.1-4.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.5.1-5">SRT Latency (TsbpdDelay) should be a buffer time large enough to cover the unexpectedly
extended RTT time, and the time needed to retransmit the lost packet. The value of minimum TsbpdDelay
is negotiated during the SRT handshake exchange and is equal to 120 milliseconds. The recommended
value of TsbpdDelay is 3-4 times RTT.<a href="#section-4.5.1-5" class="pilcrow">¶</a></p>
<p id="section-4.5.1-6">It is worth noting that TsbpdDelay limits the number of packet retransmissions to a certain extent
making impossible to retransmit packets endlessly. This is important for live data transmission.<a href="#section-4.5.1-6" class="pilcrow">¶</a></p>
<div id="tsbpd-time-base">
<section id="section-4.5.1.1">
            <h5 id="name-tsbpd-time-base-calculation">
<a href="#section-4.5.1.1" class="section-number selfRef">4.5.1.1. </a><a href="#name-tsbpd-time-base-calculation" class="section-name selfRef">TSBPD Time Base Calculation</a>
            </h5>
<p id="section-4.5.1.1-1">The initial value of TSBPD time base (TsbpdTimeBase) is calculated at the moment of
the second handshake request is received as follows:<a href="#section-4.5.1.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.5.1.1-2">
<pre>
TsbpdTimeBase = T_NOW - HSREQ_TIMESTAMP
</pre><a href="#section-4.5.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.5.1.1-3">where T_NOW is the current time according to the receiver clock;
HSREQ_TIMESTAMP is the handshake packet timestamp, in microseconds.<a href="#section-4.5.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.5.1.1-4">The value of TsbpdTimeBase is approximately equal to the initial one-way delay of the link RTT_0/2,
where RTT_0 is the actual value of the round-trip time during the SRT handshake
exchange.<a href="#section-4.5.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.5.1.1-5">During the transmission process, the value of TSBPD time base may be adjusted in two cases:<a href="#section-4.5.1.1-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.5.1.1-6">
              <li id="section-4.5.1.1-6.1">During the TSBPD wrapping period.<a href="#section-4.5.1.1-6.1" class="pilcrow">¶</a>
</li>
            </ol>
<p id="section-4.5.1.1-7">The TSBPD wrapping period happens every 01:11:35 hours. This time corresponds
to the maximum timestamp value of a packet (MAX_TIMESTAMP). MAX_TIMESTAMP is equal
to 0xFFFFFFFF, or the maximum value of 32-bit unsigned integer, in microseconds (<a href="#packet-structure" class="xref">Section 3</a>).
The TSBPD wrapping period starts 30 seconds before reaching the maximum timestamp value
of a packet and ends once the packet with timestamp within (30, 60) seconds interval
is delivered (read from the buffer). The updated value of TsbpdTimeBase will be recalculated as follows:<a href="#section-4.5.1.1-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.5.1.1-8">
<pre>
TsbpdTimeBase = TsbpdTimeBase + MAX_TIMESTAMP + 1
</pre><a href="#section-4.5.1.1-8" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-4.5.1.1-9">
              <li id="section-4.5.1.1-9.1">By drift tracer. See <a href="#drift-management" class="xref">Section 4.7</a> for details.<a href="#section-4.5.1.1-9.1" class="pilcrow">¶</a>
</li>
            </ol>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="too-late-packet-drop">
<section id="section-4.6">
        <h3 id="name-too-late-packet-drop">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-too-late-packet-drop" class="section-name selfRef">Too-Late Packet Drop</a>
        </h3>
<p id="section-4.6-1">The Too-Late Packet Drop (TLPKTDROP) mechanism allows the sender to drop packets that 
have no chance to be delivered in time, and allows the receiver to skip missing packets 
that have not been delivered in time. The timeout of dropping a packet is based on the 
TSBPD mechanism (see <a href="#tsbpd" class="xref">Section 4.5</a>).<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">In the SRT, when Too-Late Packet Drop is enabled, and a packet timestamp is older than 
125% of the SRT latency, it is considered too late to be delivered and may be dropped
by the sender. However, the sender keeps packets for at least 1 second in case the
SRT latency is not enough for a large RTT (that is, if 125% of the SRT latency is less 
than 1 second).<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<p id="section-4.6-3">When enabled on the receiver, the receiver drops packets that have not been delivered 
or retransmitted in time, and delivers the subsequent packets to the application when 
it is their time to play.<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<p id="section-4.6-4">In pseudo-code, the algorithm of reading from the receiver buffer is
the following:<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<div id="section-4.6-5">
<pre class="sourcecode">&lt;CODE BEGINS&gt;
pos = 0;  /* Current receiver buffer position */
i = 0;    /* Position of the next available in the receiver buffer
             packet relatively to the current buffer position pos */

while(True) {
    // Get the position i of the next available packet
    // in the receiver buffer
    i = next_avail();
    // Calculate packet delivery time PktTsbpdTime
    // for the next available packet
    PktTsbpdTime = delivery_time(i);

    if T_NOW &lt; PktTsbpdTime:
        continue;

    Drop packets which buffer position number is less than i;

    Deliver packet with the buffer position i;

    pos = i + 1;
}

&lt;CODE ENDS&gt;</pre><a href="#section-4.6-5" class="pilcrow">¶</a>
</div>
<p id="section-4.6-6">where T_NOW is the current time according to the receiver clock.<a href="#section-4.6-6" class="pilcrow">¶</a></p>
<p id="section-4.6-7">The TLPKTDROP mechanism can be turned off to always ensure a clean
delivery. However, a lost packet can simply pause a delivery for some
longer, potentially undefined time, and cause even worse tearing
for the player. Setting higher SRT latency will help much more in the
case when TLPKTDROP causes packet drops too often.<a href="#section-4.6-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="drift-management">
<section id="section-4.7">
        <h3 id="name-drift-management">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-drift-management" class="section-name selfRef">Drift Management</a>
        </h3>
<p id="section-4.7-1">When the sender enters "connected" status it tells the application
there is a socket interface that is transmitter-ready. At this point
the application can start sending data packets. It adds packets to
the SRT sender's buffer at a certain input rate, from which they are
transmitted to the receiver at scheduled times.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">A synchronized time is required to keep proper sender/receiver buffer
levels, taking into account the time zone and round-trip time (up to
2 seconds for satellite links). Considering addition/subtraction
round-off, and possibly unsynchronized system times, an agreed-upon
time base drifts by a few microseconds every minute. The drift may
accumulate over many days to a point where the sender or receiver
buffers will overflow or deplete, seriously affecting the quality
of the video. SRT has a time management mechanism to compensate
for this drift.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<p id="section-4.7-3">When a packet is received, SRT determines the difference between the
time it was expected and its timestamp. The timestamp is calculated on
the receiver side. The RTT tells the receiver how much time it was
supposed to take. SRT maintains a reference between the time at the
leading edge of the send buffer's latency window and the corresponding
time on the receiver (the present time). This allows to convert packet
timestamp to the local receiver time. Based on this time, various
events (packet delivery, etc.) can be scheduled.<a href="#section-4.7-3" class="pilcrow">¶</a></p>
<p id="section-4.7-4">The receiver samples time drift data and periodically calculates a
packet timestamp correction factor, which is applied to each data
packet received by adjusting the inter-packet interval. When a
packet is received it is not given right away to the application.
As time advances, the receiver knows the expected time for any
missing or dropped packet, and can use this information to fill
any "holes" in the receive queue with another packet
(see <a href="#tsbpd" class="xref">Section 4.5</a>).<a href="#section-4.7-4" class="pilcrow">¶</a></p>
<p id="section-4.7-5">It is worth noting that the period of sampling time drift data is based
on a number of packets rather than time duration to ensure enough
samples, independently of the media stream packet rate. The effect of
network jitter on the estimated time drift is attenuated by using a
large number of samples. The actual time drift being very slow (affecting a
stream only after many hours) does not require a fast reaction.<a href="#section-4.7-5" class="pilcrow">¶</a></p>
<p id="section-4.7-6">The receiver uses local time to be able to schedule events -- to
determine, for example, if it is time to deliver a certain packet
right away. The timestamps in the packets themselves are just
references to the beginning of the session. When a packet is received
(with a timestamp from the sender), the receiver makes a reference to
the beginning of the session to recalculate its timestamp. The start
time is derived from the local time at the moment that the session is
connected. A packet timestamp equals "now" minus "StartTime", where
the latter is the point in time when the socket was created.<a href="#section-4.7-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgement-and-lost-packet-handling">
<section id="section-4.8">
        <h3 id="name-acknowledgement-and-lost-pa">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-acknowledgement-and-lost-pa" class="section-name selfRef">Acknowledgement and Lost Packet Handling</a>
        </h3>
<p id="section-4.8-1">To enable the Automatic Repeat reQuest of data packet retransmissions, a sender stores
all sent data packets in its buffer.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
<p id="section-4.8-2">The SRT receiver periodically sends acknowledgments (ACKs) for the
received data packets so that the SRT sender can remove the
acknowledged packets from its buffer (<a href="#packet-acks" class="xref">Section 4.8.1</a>). Once the acknowledged packets are
removed, their retransmission is no longer possible and presumably not needed.<a href="#section-4.8-2" class="pilcrow">¶</a></p>
<p id="section-4.8-3">Upon receiving the full acknowledgment (ACK) control packet, the SRT sender should acknowledge
its reception to the receiver by sending an ACKACK control packet with the sequence number
of the full ACK packet being acknowledged.<a href="#section-4.8-3" class="pilcrow">¶</a></p>
<p id="section-4.8-4">The SRT receiver also sends NAK control packets to notify the sender about the missing packets (<a href="#packet-naks" class="xref">Section 4.8.2</a>).
The sending of a NAK packet can be triggered immediately after a gap in sequence numbers of
data packets is detected. In addition, a Periodic NAK report mechanism can be used to 
send NAK reports periodically. The NAK packet in that case will list all the packets that 
the receiver considers being lost up to the moment the Periodic NAK report is sent.<a href="#section-4.8-4" class="pilcrow">¶</a></p>
<p id="section-4.8-5">Upon reception of the NAK packet, the SRT sender prioritizes retransmissions of lost packets over the regular data
packets to be transmitted for the first time.<a href="#section-4.8-5" class="pilcrow">¶</a></p>
<p id="section-4.8-6">The retransmission of the missing packet is repeated until the receiver acknowledges its receipt,
or if both peers agree to drop this packet (see <a href="#too-late-packet-drop" class="xref">Section 4.6</a>).<a href="#section-4.8-6" class="pilcrow">¶</a></p>
<div id="packet-acks">
<section id="section-4.8.1">
          <h4 id="name-packet-acknowledgement-acks">
<a href="#section-4.8.1" class="section-number selfRef">4.8.1. </a><a href="#name-packet-acknowledgement-acks" class="section-name selfRef">Packet Acknowledgement (ACKs, ACKACKs)</a>
          </h4>
<p id="section-4.8.1-1">At certain intervals (see below), the SRT receiver sends an acknowledgment (ACK) that
causes the acknowledged packets to be removed from the SRT sender's buffer.<a href="#section-4.8.1-1" class="pilcrow">¶</a></p>
<p id="section-4.8.1-2">An ACK control packet contains the sequence number of the packet immediately
following the latest in the list of received packets. Where no packet loss has
occurred up to the packet with sequence number n, an ACK would include the sequence number (n + 1).<a href="#section-4.8.1-2" class="pilcrow">¶</a></p>
<p id="section-4.8.1-3">An ACK (from a receiver) will trigger the transmission of an ACKACK (by the sender), with almost no delay.
The time it takes for an ACK to be sent and an ACKACK to be received is the RTT.
The ACKACK tells the receiver to stop sending the ACK position because the sender already
knows it. Otherwise, ACKs (with outdated information) would continue to be sent regularly.
Similarly, if the sender does not receive an ACK, it does not stop transmitting.<a href="#section-4.8.1-3" class="pilcrow">¶</a></p>
<p id="section-4.8.1-4">There are two conditions for sending an acknowledgment. A full ACK is based on a timer of 10
milliseconds (the ACK period). For high bit rate transmissions, a "light ACK" can be sent, which is an ACK
for a sequence of packets. In a 10 milliseconds interval, there are often so many packets being sent and
received that the ACK position on the sender does not advance quickly enough. To mitigate this,
after 64 packets (even if the ACK period has not fully elapsed) the receiver sends a light ACK.
A light ACK is a shorter ACK (SRT header  and one 32-bit field). It does not trigger an ACKACK.<a href="#section-4.8.1-4" class="pilcrow">¶</a></p>
<p id="section-4.8.1-5">When a receiver encounters the situation where the next packet to be played was not
successfully received from the sender, it will "skip" this packet (see <a href="#too-late-packet-drop" class="xref">Section 4.6</a>)
and send a fake ACK. To the sender, this fake ACK is a real ACK, and so it just behaves as if the packet had been received.
This facilitates the synchronization between SRT sender and receiver. The fact that a packet was
skipped remains unknown by the sender. Skipped packets are recorded in the statistics on the
SRT receiver.<a href="#section-4.8.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="packet-naks">
<section id="section-4.8.2">
          <h4 id="name-packet-retransmission-naks">
<a href="#section-4.8.2" class="section-number selfRef">4.8.2. </a><a href="#name-packet-retransmission-naks" class="section-name selfRef">Packet Retransmission (NAKs)</a>
          </h4>
<p id="section-4.8.2-1">The SRT receiver sends NAK control packets to notify the sender about the missing packets.
The NAK packet sending can be triggered immediately after a gap in sequence numbers of
data packets is detected.<a href="#section-4.8.2-1" class="pilcrow">¶</a></p>
<p id="section-4.8.2-2">Upon reception of the NAK packet, the SRT sender prioritizes retransmissions of lost packets over the regular data
packets to be transmitted for the first time.<a href="#section-4.8.2-2" class="pilcrow">¶</a></p>
<p id="section-4.8.2-3">The SRT sender maintains a list of lost packets (loss list) that is built from NAK reports. When
scheduling packet transmission, it looks to see if a packet in the loss list has priority and sends it if so.
Otherwise, it sends the next packet scheduled for the first transmission list.
Note that when a packet is transmitted, it stays in the buffer in case it is not received by the SRT receiver.<a href="#section-4.8.2-3" class="pilcrow">¶</a></p>
<p id="section-4.8.2-4">NAK packets are processed to fill in the loss list. As the latency window advances and packets are
dropped from the sending queue, a check is performed to see if any of the dropped or resent
packets are in the loss list, to determine if they can be removed from there as well so that they
are not retransmitted unnecessarily.<a href="#section-4.8.2-4" class="pilcrow">¶</a></p>
<p id="section-4.8.2-5">There is a counter for the packets that are resent. If there is no ACK
for a packet, it will stay in the loss list and can be resent more than
once. Packets in the loss list are prioritized.<a href="#section-4.8.2-5" class="pilcrow">¶</a></p>
<p id="section-4.8.2-6">If packets in the loss list continue to block the send queue, at some point this will cause the
send queue to fill. When the send queue is full, the sender will begin to drop packets without
even sending them the first time. An encoder (or other application) may continue to provide
packets, but there's no place for them, so they will end up being thrown away.<a href="#section-4.8.2-6" class="pilcrow">¶</a></p>
<p id="section-4.8.2-7">This condition where packets are unsent does not happen often. There is a maximum number of
packets held in the send buffer based on the configured latency. Older packets that have no
chance to be retransmitted and played in time are dropped, making room for newer real-time
packets produced by the sending application. See sections <a href="#tsbpd" class="xref">Section 4.5</a>, <a href="#too-late-packet-drop" class="xref">Section 4.6</a> for details.<a href="#section-4.8.2-7" class="pilcrow">¶</a></p>
<p id="section-4.8.2-8">In addition to the regular NAKs, the Periodic NAK report mechanism can be used to send NAK reports periodically.
The NAK packet in that case will have all the packets that the receiver considers being lost
at the time of sending the Periodic NAK report.<a href="#section-4.8.2-8" class="pilcrow">¶</a></p>
<p id="section-4.8.2-9">An ACKACK tells the receiver to stop sending the ACK position because the sender already
knows it. Otherwise, ACKs (with outdated information) would continue to be sent regularly.<a href="#section-4.8.2-9" class="pilcrow">¶</a></p>
<p id="section-4.8.2-10">An ACK serves as a ping, with a corresponding ACKACK pong, to measure RTT. The time it
takes for an ACK to be sent and an ACKACK to be received is the RTT. Each ACK has a number.
A corresponding ACKACK has that same number. The receiver keeps a list of all ACKs in a
queue to match them. Unlike a full ACK, which contains the current RTT and several other
values in the CIF, a light ACK just contains the sequence number. All control messages
are sent directly and processed upon reception, but ACKACK processing time is negligible
(the time this takes is included in the round-trip time).<a href="#section-4.8.2-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="bidirectional-transmission-queues">
<section id="section-4.9">
        <h3 id="name-bidirectional-transmission-">
<a href="#section-4.9" class="section-number selfRef">4.9. </a><a href="#name-bidirectional-transmission-" class="section-name selfRef">Bidirectional Transmission Queues</a>
        </h3>
<p id="section-4.9-1">Once an SRT connection is established, both peers can send data packets simultaneously.<a href="#section-4.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="round-trip-time-estimation">
<section id="section-4.10">
        <h3 id="name-round-trip-time-estimation">
<a href="#section-4.10" class="section-number selfRef">4.10. </a><a href="#name-round-trip-time-estimation" class="section-name selfRef">Round-Trip Time Estimation</a>
        </h3>
<p id="section-4.10-1">Round-trip time (RTT) in SRT is estimated during the transmission of
data packets based on a difference in time between an ACK packet is
sent out and a corresponding ACKACK packet is received back by the
SRT receiver.<a href="#section-4.10-1" class="pilcrow">¶</a></p>
<p id="section-4.10-2">An ACK sent by the receiver triggers an ACKACK from the sender with 
minimal processing delay. The ACKACK response is expected to arrive 
at the receiver roughly one RTT after the corresponding ACK was sent.<a href="#section-4.10-2" class="pilcrow">¶</a></p>
<p id="section-4.10-3">The SRT receiver records the time when an ACK is sent out. The ACK carries
a unique sequence number (independent of the data packet sequence number).
The corresponding ACKACK also carries the same sequence number. Upon
receiving the ACKACK, SRT calculates the RTT by comparing the
difference between the ACKACK arrival time and the ACK departure time.
In the following formula, RTT is the current value that the receiver
maintains and rtt is the recent value that was just calculated from an ACK/ACKACK pair:<a href="#section-4.10-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.10-4">
<pre>
RTT = RTT * 0.875 + rtt * 0.125
</pre><a href="#section-4.10-4" class="pilcrow">¶</a>
</div>
<p id="section-4.10-5">RTT variance RTTVar is obtained as follows:<a href="#section-4.10-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.10-6">
<pre>
RTTVar = RTTVar * 0.75 + abs(RTT - rtt) * 0.25
</pre><a href="#section-4.10-6" class="pilcrow">¶</a>
</div>
<p id="section-4.10-7">where abs() means an absolute value.<a href="#section-4.10-7" class="pilcrow">¶</a></p>
<p id="section-4.10-8">Both RTT and RTTVar are measured in microseconds. The initial value of RTT is 100 milliseconds, RTTVar is 50 milliseconds.<a href="#section-4.10-8" class="pilcrow">¶</a></p>
<p id="section-4.10-9">The smoothed RTT calculated by the receiver as well as the RTT variance
RTTVar are sent with the next full acknowledgement packet (see section <a href="#ctrl-pkt-ack" class="xref">Section 3.2.3</a>).
Note that the first ACK in an SRT session might contain an initial RTT
value of 100 milliseconds, because the early calculations may not be precise.<a href="#section-4.10-9" class="pilcrow">¶</a></p>
<p id="section-4.10-10">The sender always gets the RTT from the receiver. It does not have an analog to the
ACK/ACKACK mechanism, i.e. it can not send a message that guarantees an immediate return
without processing. Upon an ACK reception, the SRT sender updates its own RTT and RTTVar
values using the same formulas as above, in which case rtt is the most recent value it receives,
i.e., carried by an incoming ACK.<a href="#section-4.10-10" class="pilcrow">¶</a></p>
<p id="section-4.10-11">Note that an SRT socket can both send and receive data packets. RTT and RTTVar are updated by the socket based on algorithms for the sender (using ACK packets) and for the receiver (using ACK-ACKACK pairs).
When an SRT socket receives data, it updates its local RTT and RTTVar, which can be used for its own sender as well.<a href="#section-4.10-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="congestion-control">
<section id="section-4.11">
        <h3 id="name-congestion-control">
<a href="#section-4.11" class="section-number selfRef">4.11. </a><a href="#name-congestion-control" class="section-name selfRef">Congestion Control</a>
        </h3>
<p id="section-4.11-1">SRT provides certain mechanisms for the sender to get some feedback
from the receiving side through the ACK packets (<a href="#ctrl-pkt-ack" class="xref">Section 3.2.3</a>).
Every 10 ms the sender receives the latest values of RTT and RTT variance,
Available Buffer Size, Packets Receiving Rate and Estimated Link Capacity.
Upon reception of the NAK packet (<a href="#ctrl-pkt-nak" class="xref">Section 3.2.4</a>) the sender can detect
packet losses during the transmission.
These mechanisms provide a solid background for various congestion control
algorithms.<a href="#section-4.11-1" class="pilcrow">¶</a></p>
<p id="section-4.11-2">Given that SRT can operate in live and file transfer modes, there are two possible groups
of congestion control algorithms.<a href="#section-4.11-2" class="pilcrow">¶</a></p>
<div id="live-congestion-control-livecc">
<section id="section-4.11.1">
          <h4 id="name-live-congestion-control-liv">
<a href="#section-4.11.1" class="section-number selfRef">4.11.1. </a><a href="#name-live-congestion-control-liv" class="section-name selfRef">Live Congestion Control (LiveCC)</a>
          </h4>
<p id="section-4.11.1-1">For live transmission mode (<a href="#transmission-mode-live" class="xref">Section 4.2.2</a>) the congestion control algorithm
does not need to control the sending pace of the data packets, as the sending timing
is provided by the live input source. It is mainly a reactor on network events. Certain
limitations on the minimal inter-sending time of consecutive packets can be applied in order
to avoid congestion during fluctuations of the source bitrate.
LiveCC determines the minimum time between consecutive packets are sent.
Also, it is allowed to drop those packets that can not be delivered in time.<a href="#section-4.11.1-1" class="pilcrow">¶</a></p>
<p id="section-4.11.1-2">On the receiving side, LiveCC may decide when an ACK is needed prior to ACK timeout.
It also determines the interval of periodic NAK packets to be reported to the sender.<a href="#section-4.11.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="file-transfer-congestion-control-filecc">
<section id="section-4.11.2">
          <h4 id="name-file-transfer-congestion-co">
<a href="#section-4.11.2" class="section-number selfRef">4.11.2. </a><a href="#name-file-transfer-congestion-co" class="section-name selfRef">File Transfer Congestion Control (FileCC)</a>
          </h4>
<p id="section-4.11.2-1">For file transfer, any known File Congestion Control algorithms, like CUBIC <span>[<a href="#RFC8312" class="xref">RFC8312</a>]</span>, can apply,
including the congestion control mechanism proposed in UDT <span>[<a href="#GHG04b" class="xref">GHG04b</a>]</span>.
The UDT congestion control relies on the available link capacity, packet loss reports (NAK)
and packet acknowledgments (ACKs).
It then slows down the output of packets as needed by adjusting the packet sending pace.
In periods of congestion, it can block the main stream and focus on the lost packets.<a href="#section-4.11.2-1" class="pilcrow">¶</a></p>
<p id="section-4.11.2-2">The algorithm consists of three states: slow start, congestion avoidance and slow down.
Starting with no information, the congestion control module probes the network to
determine the available bandwidth and the sending pace for the desired operation mode: congestion avoidance.
In this state, if there is no congestion detected via Loss reports, the sending pace is gradually increased.
On the other side, if congestion is detected in the network the state is changed to slow down and
the sending pace is decreased to reduce packet loss.<a href="#section-4.11.2-2" class="pilcrow">¶</a></p>
<div id="slow-start">
<section id="section-4.11.2.1">
            <h5 id="name-slow-start">
<a href="#section-4.11.2.1" class="section-number selfRef">4.11.2.1. </a><a href="#name-slow-start" class="section-name selfRef">Slow Start</a>
            </h5>
<p id="section-4.11.2.1-1">Slow start state has a limit on the number of data packets that can be sent before
acknowledgment of those segments is received. File CC starts with 16 DATA packets (CWND_SIZE=16)
sent with minimum possible interval.<a href="#section-4.11.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.11.2.1-2">CWND_SIZE is increased by the difference between the acknowledged sequence number since last ACK processing
and the sequence number being acknowledged:<a href="#section-4.11.2.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.11.2.1-3">
<pre>
CWND_SIZE += LAST_ACK_SEQNO - ACK_SEQNO
</pre><a href="#section-4.11.2.1-3" class="pilcrow">¶</a>
</div>
<p id="section-4.11.2.1-4">When the congestion window size exceeds its maximum set value (MAX_CWND_SIZE), slow start period ends. Note
that this congestion maximum window size is equal to the flow window size (FLOW_WND_SIZE). If a delivery
rate was reported by the receiver the inter sending interval is set as:<a href="#section-4.11.2.1-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.11.2.1-5">
<pre>
PKT_SND_PERIOD = 1000000.0 / DELIVERY_RATE
</pre><a href="#section-4.11.2.1-5" class="pilcrow">¶</a>
</div>
<p id="section-4.11.2.1-6">If delivery rate has not been reported, the sending period is set to:<a href="#section-4.11.2.1-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.11.2.1-7">
<pre>
PKT_SND_PERIOD = CWND_SIZE / (RTT + RC_INTERVAL)
</pre><a href="#section-4.11.2.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="congestion-avoidance">
<section id="section-4.11.2.2">
            <h5 id="name-congestion-avoidance">
<a href="#section-4.11.2.2" class="section-number selfRef">4.11.2.2. </a><a href="#name-congestion-avoidance" class="section-name selfRef">Congestion Avoidance</a>
            </h5>
<p id="section-4.11.2.2-1">At the end of the slow start state, the congestion avoidance state begins. If the estimated bandwidth (B) is
smaller than the actual sending rate (1/PKT_SND_PERIOD), the increase (inc) is equal to the inverse of MSS.<a href="#section-4.11.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.11.2.2-2">If not the increase is computed as:<a href="#section-4.11.2.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.11.2.2-3">
<pre>
inc = max(10 ^ ceil(log10( B * MSS * 8 ) * Beta / MSS, 1/MSS)
</pre><a href="#section-4.11.2.2-3" class="pilcrow">¶</a>
</div>
<p id="section-4.11.2.2-4">With beta being a constant set to 1.5 * 10^(-6). The variable inc is capped at 1/MSS.<a href="#section-4.11.2.2-4" class="pilcrow">¶</a></p>
<p id="section-4.11.2.2-5">The new sending period is then calculated as:<a href="#section-4.11.2.2-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.11.2.2-6">
<pre>
PKT_SND_PERIOD = (PKT_SND_PERIOD * RC_INTERVAL) / (PKT_SND_PERIOD * inc + RC_INTERVAL)
</pre><a href="#section-4.11.2.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="slow-down">
<section id="section-4.11.2.3">
            <h5 id="name-slow-down">
<a href="#section-4.11.2.3" class="section-number selfRef">4.11.2.3. </a><a href="#name-slow-down" class="section-name selfRef">Slow Down</a>
            </h5>
<p id="section-4.11.2.3-1">Upon the arrival of a NACK a congestion period is started if the lost packet sequence in the NACK
is bigger than the largest sequence number sent so far (LastDecSeq).<a href="#section-4.11.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.11.2.3-2">The decreasing sending rate is computed with the following variables:<a href="#section-4.11.2.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.11.2.3-3.1">AvgNAKNum: The average number of NACKs. Initial value: 1.<a href="#section-4.11.2.3-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.11.2.3-3.2">NAKCount: Number of NACKs received in the current congestion period. Initial value: 1.<a href="#section-4.11.2.3-3.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.11.2.3-3.3">DecCount: Number of times the sending period has been increased in the former congestion period.
Initial value: 0.<a href="#section-4.11.2.3-3.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.11.2.3-3.4">DecRandom: Uniformly distributed random number to avoid global synchronization. Ranges from 1 to AvgNAKNum.<a href="#section-4.11.2.3-3.4" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.11.2.3-4">When a new congestion period is started the previously enumerated variables are reset and the
packet sending period is increased as:<a href="#section-4.11.2.3-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.11.2.3-5">
<pre>
PKT_SND_PERIOD = PKT_SND_PERIOD * 1.125
</pre><a href="#section-4.11.2.3-5" class="pilcrow">¶</a>
</div>
<p id="section-4.11.2.3-6">If the following statement is true:<a href="#section-4.11.2.3-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.11.2.3-7">
<pre>
DecCount &lt;= 5 and NAKCount == DecCount * DecRandom
</pre><a href="#section-4.11.2.3-7" class="pilcrow">¶</a>
</div>
<p id="section-4.11.2.3-8">The PKT_SND_PERIOD and DecCount are increased:<a href="#section-4.11.2.3-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.11.2.3-9">
<pre>
PKT_SND_PERIOD = PKT_SND_PERIOD * 1.125
DecCount += 1
</pre><a href="#section-4.11.2.3-9" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="encryption">
<section id="section-5">
      <h2 id="name-encryption">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-encryption" class="section-name selfRef">Encryption</a>
      </h2>
<p id="section-5-1">This section describes the encryption mechanism that protects the payload of SRT streams.
Based on standard cryptographic algorithms, the mechanism allows an efficient stream cipher
with a key establishment method.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="overview">
<section id="section-5.1">
        <h3 id="name-overview">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-5.1-1">AES in counter mode (AES-CTR) is used with a short-lived key to encrypt the media stream.
This cipher is suitable for random access of a continuous stream, content protection
(used by HDCP 2.0), and strong confidentiality when the counter is managed properly.
SRT implements encryption using AES-CTR mode, effectively using encryption to decrypt
an encrypted packet.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">SRT encrypts the media stream at the Transmission Payload level
(UDP payload of MPEG-TS/UDP encapsulation, which is about 7 MPEG-TS packets of 188 bytes each).
A small packet header is required to keep the synchronization of the cipher counter
between the encoder and the decoders. No padding is required by counter mode ciphers.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">What is encrypted is a 128-bit counter, which is then used to do an XOR with each block
of 128 bits in a packet, resulting in the ciphertext to transmit (this is the XOR technique 
for counter mode).<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">The counter for AES-CTR is the size of the cipher's block, i.e. 128 bits. It is derived from
a 128-bit sequence consisting of (1) a block counter in the least significant 16 bits, 
which counts the blocks in a packet, (2) a packet index - based on the packet sequence number
in the UDT header - in the next 32 bits, and (3) eighty bits that are zeroes.
The upper 112 bits of this sequence are XORed with an initialization vector (IV)
to produce a unique counter for each crypto block. Note that the block counter is unique for 
the duration of the session. The same counter cannot be used twice.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">This key used for encryption is called the "Stream Encrypting Key" (SEK), which is used for
2^25 packets.
The short-lived SEK is generated by the sender using a pseudo-random number generator (PRNG),
and transmitted within the stream (KM Tx Period), wrapped with another longer-term key,
the Key Encrypting Key (KEK), using a known AES key wrap protocol.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">For connection-oriented transport such as SRT, there is no need to periodically transmit
the short-lived key since no party can join the stream at any time. The keying material
is transmitted within the connection handshake packets, and for a short period
when rekeying occurs.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1-7">The KEK is derived from a secret shared (e.g. passphrase) between the sender and the receiver.
The shared secret provides access to the stream key, which provides access to the protected
media stream. The distribution and management of the secret is more flexible than the stream
encrypting key. The KEK has to be at least as long as the SEK.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<p id="section-5.1-8">The KEK is generated by a password-based key generation function (PBKDF2),
which uses the passphrase, a number of iterations (2048), a keyed-hash (HMAC-SHA1), and
a length KEYLEN. The PBKDF2 function hashes the passphrase to make a long string,
by repetition or padding. The number of iterations is based on how much time can be given to
the process without it becoming disruptive.<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<p id="section-5.1-9">The KEK is used to generate a wrap <span>[<a href="#RFC3394" class="xref">RFC3394</a>]</span> that is put in a key material (KM) message
to send to the receiver. The KM message contains the key length,
the salt (one of the arguments provided to the PBKDF2 function), the protocol being used
(AES-256 in this case) and the AES counter (which will eventually change).<a href="#section-5.1-9" class="pilcrow">¶</a></p>
<p id="section-5.1-10">On the other side, the receiver attempts to decode the wrap to obtain the key. In the protocol
for the wrap there is a padding, which is a known template, so the receiver knows from the KM
that it has the right KEK to decode the SEK.
The SEK (generated and transmitted by the sender) is random, and cannot be known in advance.
The KEK formula is calculated on both sides, with the difference that the receiver gets
the key length (KEYLEN) from the sender via the key material (KM).
It is the sender who decides on the configured length. The receiver obtains it from
the material sent by the sender. This is why the length is not configured on a decoder,
thus avoiding the need to match.<a href="#section-5.1-10" class="pilcrow">¶</a></p>
<p id="section-5.1-11">The receiver returns the same KM message to show that it has the same information as the sender,
and that the encoded material will be decrypted. If the receiver does not return this status,
this means that any encrypted packets from the sender will be lost. Even if they are transmitted
successfully, the receiver will be unable to decrypt them, and so will be dropped.
In the UDT design, even if one peer could not decrypt, this did not mean that others should not 
receive the information. In UDT, the key exchange is a one way process, where the key is
regularly injected into a stream so that it can be received at any time. But with SRT the connection
is established in the beginning, so the key exchange happens then.
It cannot be done just anywhere in the stream.<a href="#section-5.1-11" class="pilcrow">¶</a></p>
<p id="section-5.1-12">The short lived SEK is regenerated for cryptographic reasons when enough packets have been
encrypted with it by implementation of either side. One example implementation has default
value of 2^25, with a pre-announcement period of 4000 packets (i.e. a new key is generated,
wrapped, and sent at 2^25 minus 4000 packets). Even and odd keys are alternated this way.
The packets with the earlier key (we will call it key #1, or "odd") will continue to be sent.
The receiver will receive the new key #2 (even), then decrypt and unwrap it.
The receiver will reply to the sender if it is able to understand.
Once the sender gets to the 2^25 packet using the odd key (key #1), it will then start to
send packets with the even key (key #2). It knows that the receiver has what it needs to
decrypt that even key (key #2). This happens transparently, from one packet to the next.
At 2^25 plus 4000 packets the first key will be decommissioned automatically in this example
implementation.<a href="#section-5.1-12" class="pilcrow">¶</a></p>
<p id="section-5.1-13">The keys live in parallel for a certain period of time. A bit before and a bit after the given
refresh point (in the previous example, the 2^25) there are two keys that exist in parallel,
in case there is retransmission. It is possible for packets with the older key to arrive
at the receiver a bit late. Each packet contains a description of which key it requires,
so the receiver will still have the ability to decrypt it.<a href="#section-5.1-13" class="pilcrow">¶</a></p>
<p id="section-5.1-14">During handshake process, keying materials piggyback on the second round-trip,
including the response. The handshake initiator sends the key length,
and then the key material exchange happens on the last trip.<a href="#section-5.1-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="definitions-for-encryption-mechanism">
<section id="section-5.2">
        <h3 id="name-definitions-for-encryption-">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-definitions-for-encryption-" class="section-name selfRef">Definitions for encryption mechanism</a>
        </h3>
<div id="ciphers-aes-ctr">
<section id="section-5.2.1">
          <h4 id="name-ciphers-aes-ctr">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-ciphers-aes-ctr" class="section-name selfRef">Ciphers (AES-CTR)</a>
          </h4>
<p id="section-5.2.1-1">The payload is encrypted with a cipher in counter mode (AES-CTR).
The AES counter mode is one of the only cipher modes suitable for continuous stream encryption
that permits decryption from any point, without access to start of the stream (random access),
and for the same reason tolerates packet lost.
The Electronic Code Book (ECB) mode also has these characteristics but does not provide serious
confidentiality and is not recommended in cryptography.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">Integrity protection might eventually be achieved with an Authenticated Encryption with
Associated Data (AEAD) cipher such as AES-CCM or AES-GCM.
These cipher modes remove the need of a separate message authentication protocol such as SHA-2.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="media-stream-message-msmsg">
<section id="section-5.2.2">
          <h4 id="name-media-stream-message-msmsg">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-media-stream-message-msmsg" class="section-name selfRef">Media Stream Message (MSmsg)</a>
          </h4>
<p id="section-5.2.2-1">The Media Stream message is formed from the SRT media stream (data) packets with some elements of
the SRT header used for the cryptography. An SRT header already carries a 32-bit packet sequence
number that is used for the cipher's counter (ctr), with 2 bits taken from the header's message number
(which is thereby reduced to 27 bits) for the encryption key (odd/even) indicator.
Note that the message number field is used when the message is larger than the MTU are send,
which is not the case for MPEG-TS/SRT so the reduction to 27 bits is without consequence.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="keying-material">
<section id="section-5.2.3">
          <h4 id="name-keying-material">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-keying-material" class="section-name selfRef">Keying Material</a>
          </h4>
<p id="section-5.2.3-1">For each stream, the sender generates a Stream Encrypting Key (SEK) and a Salt.
For the initial implementation and for most envisioned scenarios where no separate
authentication algorithm is used for message integrity, the SEK is used directly
to encrypt the media stream. The Initial Vector (IV) for the counter is derived from the Salt only.
In other scenarios, the SEK can be used along with the Salt as a key generating material
to produce distinct encryption, authentication, and salt keys.<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="stream-encrypting-key-sek">
<section id="section-5.2.4">
          <h4 id="name-stream-encrypting-key-sek">
<a href="#section-5.2.4" class="section-number selfRef">5.2.4. </a><a href="#name-stream-encrypting-key-sek" class="section-name selfRef">Stream Encrypting Key (SEK)</a>
          </h4>
<p id="section-5.2.4-1">The Stream Encrypting Key (SEK) is pseudo-random and different for each stream.
It must be 128, 192, or 256 bits long for the AES-CTR ciphers.
It is non-persistent and relatively short lived.
In a typical scenario the SEK is expected to last, in cryptographic terms,
around 37 days for a 31-bit counter (2^31 packets / 667 packets/second).<a href="#section-5.2.4-1" class="pilcrow">¶</a></p>
<p id="section-5.2.4-2">The SEK is regenerated every time a stream starts and does not survive system reboot.
It must be discarded before 2^31 packets are encrypted (31-bit packet index) according
to an implementation example of SRT and replaced seamlessly using an odd/even
key mechanism described below.
Reusing an IV with the same key on different clear text is a known catastrophic issue
of counter mode ciphers. By regenerating the SEK each time a stream starts we remove
the need for elaborate management of the IV to ensure uniqueness.<a href="#section-5.2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initialization-vector-iv">
<section id="section-5.2.5">
          <h4 id="name-initialization-vector-iv">
<a href="#section-5.2.5" class="section-number selfRef">5.2.5. </a><a href="#name-initialization-vector-iv" class="section-name selfRef">Initialization Vector (IV)</a>
          </h4>
<p id="section-5.2.5-1">The IV (also called "nonce" in the AES-CTR context) is a 112-bit random number.
For the initial implementation of SRT and for most envisioned scenarios
where no separate authentication algorithm is used for message integrity (Auth=0),
the IV is derived from the salt only.<a href="#section-5.2.5-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2.5-2">
            <dt id="section-5.2.5-2.1">IV = MSB(112, Salt):</dt>
            <dd id="section-5.2.5-2.2">
  Most significant 112 bits of the salt.<a href="#section-5.2.5-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="counter-ctr">
<section id="section-5.2.6">
          <h4 id="name-counter-ctr">
<a href="#section-5.2.6" class="section-number selfRef">5.2.6. </a><a href="#name-counter-ctr" class="section-name selfRef">Counter (ctr)</a>
          </h4>
<p id="section-5.2.6-1">The counter for AES-CTR is the size of the cipher's block, i.e. 128 bits.
It is based on a block counter in the least significant 16 bits, for counting blocks
of a packet, a packet index in the next 32 bits, and 80 zeroed bits.
The upper 112 bits are XORed with the IV to produce a unique counter for each crypto block.<a href="#section-5.2.6-1" class="pilcrow">¶</a></p>
<p id="section-5.2.6-2">The block counter (bctr) is incremented for each cipher block while producing the key stream.
The packet index is incremented for each packet submitted to the cipher.
The IV is derived from the Salt provided with the Keying Material.<a href="#section-5.2.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="keying-material-message-kmmsg">
<section id="section-5.2.7">
          <h4 id="name-keying-material-message-kmm">
<a href="#section-5.2.7" class="section-number selfRef">5.2.7. </a><a href="#name-keying-material-message-kmm" class="section-name selfRef">Keying Material message (KMmsg)</a>
          </h4>
<p id="section-5.2.7-1">The SEK and a salt are transported in-stream, in a Keying Material message (KMmsg),
implemented as a custom SRT control packet, wrapped with a longer term Key Encrypting Key (KEK)
using AES key wrap <span>[<a href="#RFC3394" class="xref">RFC3394</a>]</span>.<a href="#section-5.2.7-1" class="pilcrow">¶</a></p>
<p id="section-5.2.7-2">The connection-oriented SRT KM control packet is transmitted at the start of the connection,
before any data packet. In most cases, if the control packet is not lost, the receiver
is able to decrypt starting with the first packet. Otherwise, the initial packets are dropped
(or stored for later decryption) until the KM control packet is received
(the SRT control packet is retransmitted until acknowledged by the receiver).<a href="#section-5.2.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oddeven-stream-encrypting-key-osekesek">
<section id="section-5.2.8">
          <h4 id="name-odd-even-stream-encrypting-">
<a href="#section-5.2.8" class="section-number selfRef">5.2.8. </a><a href="#name-odd-even-stream-encrypting-" class="section-name selfRef">Odd/Even Stream Encrypting Key (oSEK/eSEK)</a>
          </h4>
<p id="section-5.2.8-1">To ensure seamless rekeying for cryptographic (counter exhausted) or access control reasons,
SRT employs a two-key mechanism, similar to the one used with DVB systems.
The two keys are identified as the odd key and the even key (oSEK/eSEK).
An odd/even flag in the SRT data header tells which key is in use. 
The next key to be used is transmitted in advance to the receivers in an SRT control packet.
When rekeying occurs, the SRT data header odd/even flag flips, and the receiver already has
the new key in hand to continue decrypting the stream without missing a packet.<a href="#section-5.2.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-encrypting-key-kek">
<section id="section-5.2.9">
          <h4 id="name-key-encrypting-key-kek">
<a href="#section-5.2.9" class="section-number selfRef">5.2.9. </a><a href="#name-key-encrypting-key-kek" class="section-name selfRef">Key Encrypting Key (KEK)</a>
          </h4>
<p id="section-5.2.9-1">The Key Encrypting Key (KEK) is used by the sender to wrap the SEK, and by the receiver to
unwrap it and then decrypt the stream. The KEK must be at least the size of the key it protects,
the SEK. The KEK is derived from a shared secret, a pre-shared password by default.<a href="#section-5.2.9-1" class="pilcrow">¶</a></p>
<p id="section-5.2.9-2">The KEK is derived with the PBKDF2  derivation function with the stream
Salt and the shared secret for input.
Each stream then uses a unique KEK to encrypt its Keying Material.
A compromised KEK does not compromise other streams protected with the same shared secret
(but a compromised shared secret compromises all streams protected with KEK derived from it).
Late derivation of the KEK using stream Salt also permits the generation
of a KEK of the proper size, based on the size of the key it protects.<a href="#section-5.2.9-2" class="pilcrow">¶</a></p>
<p id="section-5.2.9-3">The shared secret can be pre-shared; password derived PKCS5;
distributed using a proprietary mechanism, or by using a standard key distribution mechanism
such as GDOI <span>[<a href="#RFC3547" class="xref">RFC3547</a>]</span> or MIKEY <span>[<a href="#RFC3830" class="xref">RFC3830</a>]</span>.<a href="#section-5.2.9-3" class="pilcrow">¶</a></p>
<p id="section-5.2.9-4">The cryptographic usage limit of the KEK is 248 wraps (AESKW) which means virtual infinity
at the expected SEK rekeying rate (90,000 years to rekey 100 keys every second).<a href="#section-5.2.9-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="encryption-process-walkthrough">
<section id="section-5.3">
        <h3 id="name-encryption-process-walkthro">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-encryption-process-walkthro" class="section-name selfRef">Encryption Process Walkthrough</a>
        </h3>
<div id="stream-configuration">
<section id="section-5.3.1">
          <h4 id="name-stream-configuration">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-stream-configuration" class="section-name selfRef">Stream configuration</a>
          </h4>
<p id="section-5.3.1-1">In the simplest stream protection form, a stream is configured with a password
(preferably a passphrase) to enable encryption. The sender decides to protect or not.
On the receiver, a configured passphrase is used only if the incoming media stream is encrypted.
A receiver knows that a received stream is encrypted and how (cipher/key length),
based on the received stream itself - not because it has a password configured.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2">In the absence of security policies, operators and admins can perform this task.
The only other parameter to set in the initial implementation of SRT, which uses only AES-CTR,
is the key size: 128, 192, or 256.<a href="#section-5.3.1-2" class="pilcrow">¶</a></p>
<p id="section-5.3.1-3">A system-wide stream protection passphrase (and other crypto parameters) can also be set
by a Security Officer. On the sender, a stream can be protected by only enabling encryption
(using a system-wide passphrase derived key).
On the receiver, no specific setting is required if the decoder detects encryption
from the received stream and has access to the system-wide passphrase to decrypt it.<a href="#section-5.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="keying-material-generation">
<section id="section-5.3.2">
          <h4 id="name-keying-material-generation">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-keying-material-generation" class="section-name selfRef">Keying Material Generation</a>
          </h4>
<div id="sek-salt-and-kek">
<section id="section-5.3.2.1">
            <h5 id="name-sek-salt-and-kek">
<a href="#section-5.3.2.1" class="section-number selfRef">5.3.2.1. </a><a href="#name-sek-salt-and-kek" class="section-name selfRef">SEK, Salt, and KEK</a>
            </h5>
<p id="section-5.3.2.1-1">For each protected stream, the encoder generates a random SEK and Salt.
In the case of a pre-shared password derived key, it derives the KEK from 
the pre-shared secret and the 64 least significant bits of the Salt.<a href="#section-5.3.2.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.3.2.1-2">
<pre>
SEK = PRNG(Klen)
Salt = PRNG(128)
KEK = PBKDF2(password, LSB(64,Salt), Iter, Klen)
</pre><a href="#section-5.3.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3.2.1-3">PRNG is a pseudo-random number generator, Klen is the key length (128, 192, 256), 
PBKDF2 is the Password Based Key Derivation Function 2.0 ,
and Iter is the iteration count (2048).
For proper protection, the KEK must be at least as long as the key it protects.<a href="#section-5.3.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="kmmsg">
<section id="section-5.3.2.2">
            <h5 id="name-kmmsg">
<a href="#section-5.3.2.2" class="section-number selfRef">5.3.2.2. </a><a href="#name-kmmsg" class="section-name selfRef">KMmsg</a>
            </h5>
<p id="section-5.3.2.2-1">The encoder assembles the Keying Material message once for the life of the SEK and transmits
it periodically. It may be assembled twice if the 2nd key (odd and even) is later added
and transmitted in the same message for seamless rekeying (SEK = eSEK || oSEK).<a href="#section-5.3.2.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.3.2.2-2">
<pre>
Wrap = AESkw(KEK, SEK)
KMmsg = Header || CryptoInfo || Wrap
</pre><a href="#section-5.3.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="encryption-and-transmission">
<section id="section-5.3.2.3">
            <h5 id="name-encryption-and-transmission">
<a href="#section-5.3.2.3" class="section-number selfRef">5.3.2.3. </a><a href="#name-encryption-and-transmission" class="section-name selfRef">Encryption and Transmission</a>
            </h5>
</section>
</div>
<div id="kmmsg-transmission-km-tx-period">
<section id="section-5.3.2.4">
            <h5 id="name-kmmsg-transmission-km-tx-pe">
<a href="#section-5.3.2.4" class="section-number selfRef">5.3.2.4. </a><a href="#name-kmmsg-transmission-km-tx-pe" class="section-name selfRef">KMmsg Transmission (KM Tx Period)</a>
            </h5>
<p id="section-5.3.2.4-1">The sender transmits the KMmsg periodically, for example, every second.<a href="#section-5.3.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-stream-generation">
<section id="section-5.3.2.5">
            <h5 id="name-key-stream-generation">
<a href="#section-5.3.2.5" class="section-number selfRef">5.3.2.5. </a><a href="#name-key-stream-generation" class="section-name selfRef">Key Stream Generation</a>
            </h5>
<p id="section-5.3.2.5-1">When a co-processor is used for cryptography the key stream can be generated in parallel,
in advance of the media stream. The initial counter is generated from the IV and the Salt.<a href="#section-5.3.2.5-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.3.2.5-2">
<pre>
IV = MSB(112, Salt)
ctr = (IV112 || 016) XOR (index32 || 016)
KeyStream[index] = AES(SEK, ctr) || AES(SEK, ctr+1) || ... || AES(SEK, ctr+n-1)
index = index + 1
</pre><a href="#section-5.3.2.5-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3.2.5-3">'n' is the number of 128 bits block in the payload.<a href="#section-5.3.2.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="media-stream-message-generation">
<section id="section-5.3.2.6">
            <h5 id="name-media-stream-message-genera">
<a href="#section-5.3.2.6" class="section-number selfRef">5.3.2.6. </a><a href="#name-media-stream-message-genera" class="section-name selfRef">Media Stream Message Generation</a>
            </h5>
<p id="section-5.3.2.6-1">The MPEG-TS/UDP payload is XORed with the Key stream:<a href="#section-5.3.2.6-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.3.2.6-2">
<pre>
MSmsg[index] = Header || index || (KeyStream[index] XOR payload[index])
</pre><a href="#section-5.3.2.6-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="reception-and-decryption">
<section id="section-5.3.2.7">
            <h5 id="name-reception-and-decryption">
<a href="#section-5.3.2.7" class="section-number selfRef">5.3.2.7. </a><a href="#name-reception-and-decryption" class="section-name selfRef">Reception and Decryption</a>
            </h5>
</section>
</div>
<div id="detect-encryption">
<section id="section-5.3.2.8">
            <h5 id="name-detect-encryption">
<a href="#section-5.3.2.8" class="section-number selfRef">5.3.2.8. </a><a href="#name-detect-encryption" class="section-name selfRef">Detect Encryption</a>
            </h5>
<p id="section-5.3.2.8-1">The receiver of a stream can detect from the message whether or not the stream is encrypted.<a href="#section-5.3.2.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="regenerate-the-kek-sek-and-iv">
<section id="section-5.3.2.9">
            <h5 id="name-regenerate-the-kek-sek-and-">
<a href="#section-5.3.2.9" class="section-number selfRef">5.3.2.9. </a><a href="#name-regenerate-the-kek-sek-and-" class="section-name selfRef">Regenerate the KEK, SEK and IV</a>
            </h5>
<p id="section-5.3.2.9-1">If the receiver does not have the Keying Material,
it waits for a KMmsg to extract the Salt and Wrap.
With the pre-shared password and the Salt it regenerates the KEK and
then unwrap the SEK. It checks the Wrap integrity from the Integrity Check Vector.<a href="#section-5.3.2.9-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.3.2.9-2">
<pre>
KEK = PBKDF2(password, Salt, Iter, Klen)
ICV || SEK = AESkw(KEK, Wrap)
</pre><a href="#section-5.3.2.9-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="generate-key-stream">
<section id="section-5.3.2.10">
            <h5 id="name-generate-key-stream">
<a href="#section-5.3.2.10" class="section-number selfRef">5.3.2.10. </a><a href="#name-generate-key-stream" class="section-name selfRef">Generate Key Stream</a>
            </h5>
<p id="section-5.3.2.10-1">With the next stream message (MSmsg) the receiver grabs the packet counter and odd/even
key flag from the clear text header and prepares the cipher to generate a key stream for some
packets in advance.<a href="#section-5.3.2.10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="counter-preset">
<section id="section-5.3.2.11">
            <h5 id="name-counter-preset">
<a href="#section-5.3.2.11" class="section-number selfRef">5.3.2.11. </a><a href="#name-counter-preset" class="section-name selfRef">Counter Preset</a>
            </h5>
<p id="section-5.3.2.11-1">As an optimization, while waiting for the first KMmsg, the decoder can grab the packet counter
and odd/even flag from the stream message (MSmsg) received before the KMmsg and know
what the packet counter of the next MSmsg should be, then prepares the cipher earlier.<a href="#section-5.3.2.11-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="early-frames-vs-latency">
<section id="section-5.3.2.12">
            <h5 id="name-early-frames-vs-latency">
<a href="#section-5.3.2.12" class="section-number selfRef">5.3.2.12. </a><a href="#name-early-frames-vs-latency" class="section-name selfRef">Early Frames vs. Latency</a>
            </h5>
<p id="section-5.3.2.12-1">If the key stream is generated in any arrangement where a crypto processor can process
the key stream in parallel, there is a choice between displaying the earlier frames received or
achieving low latency.<a href="#section-5.3.2.12-1" class="pilcrow">¶</a></p>
<p id="section-5.3.2.12-2">When a decoder has prepared the cipher to generate the key stream, it has the choice to (1) store
the received stream packets until the key stream is ready, and then display the earliest received
frame with some latency (the lag between the first packet buffered and the first packet
decrypted and displayed), or (2) drop the early packets until the key stream is ready, and then
achieve lower latency. It is assumed here that the crypto engine can thereafter generate the key
stream as fast as it receives MSmsg.<a href="#section-5.3.2.12-2" class="pilcrow">¶</a></p>
<p id="section-5.3.2.12-3">While it would be possible to buffer the received stream packets before receiving the KMmsg,
there is no guarantee that the odd or even key used to encrypt these messages is the one
encrypted in the KMmsg received after, especially if backward secrecy is achieved (where a new
receiver cannot decrypt an earlier stream).<a href="#section-5.3.2.12-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="to-remove">
<section id="section-5.4">
        <h3 id="name-to-remove">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-to-remove" class="section-name selfRef">TO Remove</a>
        </h3>
<div id="keki-to-be-moved-to-a-relevan-section">
<section id="section-5.4.1">
          <h4 id="name-keki-to-be-moved-to-a-relev">
<a href="#section-5.4.1" class="section-number selfRef">5.4.1. </a><a href="#name-keki-to-be-moved-to-a-relev" class="section-name selfRef">KEKI (to be moved to a relevan section)</a>
          </h4>
<p id="section-5.4.1-1">If it is required to seamlessly change the KEK for good security practice (key lifetime elapsed),
to preserve backward/forward secrecy when a new receiver joins/leaves,
for a security breach (compromised KEK or device),
or if there are multiple sensitive streams to protect (e.g. secret, sensitive, public, etc.),
then the system needs to manage multiple keys and this fields tells which one to use.<a href="#section-5.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">SRT supports confidentiality of user data using stream ciphering based on AES.
Session keys for ciphering are delivered through control packets during handshake,
with the protection by Key Encryption Key, which is generated by a sender and receiver
with pre-shared secret such as passphrase. As in UDT, careful uses of SYN Cookies
may help to deter denial of service attacks. Appropriate security policy including
key size, key refresh period, as well as passphrase should be managed by security
officers, which is out of scope of the present document.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document makes no requests of the IANA.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="section-8">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="section-8-1">This specification is heavily based on the SRT Protocol Technical Overview <span>[<a href="#SRTTO" class="xref">SRTTO</a>]</span>
written by Jean Dube and Steve Matthews.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">In alphabetical order, the contributors to the pre-IETF SRT project and
specification at Haivision are: Marc Cymontkowski, Roman Diouskine,
Jean Dube, Mikolaj Malecki, Steve Matthews, Maria Sharabayko,
Maxim Sharabayko, Adam Yellen.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">The contributors to this specification at SK Telecom
are Jeongseok Kim and Joonwoong Kim.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">We cannot list all the contributors to the open-sourced implementation of SRT on GitHub.
But we appreciate the help, contribution, integrations and feedback of the
SRT and SRT Alliances community.<a href="#section-8-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="section-9">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-9-1">The basis of the SRT protocol and its implementation was
the UDP-based Data Transfer Protocol <span>[<a href="#GHG04b" class="xref">GHG04b</a>]</span>.
The authors thank Yunhong Gu and Robert Grossman,
the authors of the UDP-based Data Transfer Protocol <span>[<a href="#GHG04b" class="xref">GHG04b</a>]</span>.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">TODO acknowledge.<a href="#section-9-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC0768">[RFC0768]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"User Datagram Protocol"</span>, <span class="seriesInfo">STD 6</span>, <span class="seriesInfo">RFC 768</span>, <span class="seriesInfo">DOI 10.17487/RFC0768</span>, <time datetime="1980-08" class="refDate">August 1980</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc768">https://www.rfc-editor.org/info/rfc768</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="AV1">[AV1]</dt>
        <dd>
<span class="refAuthor">Rivaz, P.d.</span><span class="refAuthor"> and J. Haughton</span>, <span class="refTitle">"AV1 Bitstream &amp; Decoding Process Specification"</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://aomediacodec.github.io/av1-spec/av1-spec.pdf">https://aomediacodec.github.io/av1-spec/av1-spec.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GHG04b">[GHG04b]</dt>
        <dd>
<span class="refAuthor">Gu, Y.</span><span class="refAuthor">, Hong, X.</span><span class="refAuthor">, and R.L. Grossman,</span>, <span class="refTitle">"Experiences in Design and Implementation of a High Performance Transport Protocol"</span>, <span class="seriesInfo">DOI 10.1109/SC.2004.24</span>, <time datetime="2004-12" class="refDate">December 2004</time>, <span>&lt;<a href="https://doi.org/10.1109/SC.2004.24">https://doi.org/10.1109/SC.2004.24</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="H.265">[H.265]</dt>
        <dd>
<span class="refAuthor">International Telecommunications Union</span>, <span class="refTitle">"H.265 : High efficiency video coding"</span>, <span class="seriesInfo">ITU-T Recommendation H.265</span>, <time datetime="2019" class="refDate">2019</time>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-quic-http">[I-D.ietf-quic-http]</dt>
        <dd>
<span class="refAuthor">Bishop, M.</span>, <span class="refTitle">"Hypertext Transfer Protocol Version 3 (HTTP/3)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-http-29</span>, <time datetime="2020-06-09" class="refDate">9 June 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-quic-http-29.txt">http://www.ietf.org/internet-drafts/draft-ietf-quic-http-29.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-quic-transport">[I-D.ietf-quic-transport]</dt>
        <dd>
<span class="refAuthor">Iyengar, J.</span><span class="refAuthor"> and M. Thomson</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-transport-29</span>, <time datetime="2020-06-09" class="refDate">9 June 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-quic-transport-29.txt">http://www.ietf.org/internet-drafts/draft-ietf-quic-transport-29.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO13818-1">[ISO13818-1]</dt>
        <dd>
<span class="refAuthor">ISO</span>, <span class="refTitle">"Information technology -- Generic coding of moving pictures and associated audio information: Systems"</span>, <span class="seriesInfo">ISO/IEC 13818-1</span>, <time datetime="2020-09" class="refDate">September 2020</time>. </dd>
<dd class="break"></dd>
<dt id="ISO23009">[ISO23009]</dt>
        <dd>
<span class="refAuthor">ISO</span>, <span class="refTitle">"Information technology -- Dynamic adaptive streaming over HTTP (DASH)"</span>, <span class="seriesInfo">ISO/IEC 23009:2019</span>, <time datetime="2020-09" class="refDate">September 2020</time>. </dd>
<dd class="break"></dd>
<dt id="PNPID">[PNPID]</dt>
        <dd>
<span class="refTitle">"PNP ID AND ACPI ID REGISTRY"</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://uefi.org/PNP_ACPI_Registry">https://uefi.org/PNP_ACPI_Registry</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3031">[RFC3031]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span><span class="refAuthor">, Viswanathan, A.</span><span class="refAuthor">, and R. Callon</span>, <span class="refTitle">"Multiprotocol Label Switching Architecture"</span>, <span class="seriesInfo">RFC 3031</span>, <span class="seriesInfo">DOI 10.17487/RFC3031</span>, <time datetime="2001-01" class="refDate">January 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3031">https://www.rfc-editor.org/info/rfc3031</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3394">[RFC3394]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span><span class="refAuthor"> and R. Housley</span>, <span class="refTitle">"Advanced Encryption Standard (AES) Key Wrap Algorithm"</span>, <span class="seriesInfo">RFC 3394</span>, <span class="seriesInfo">DOI 10.17487/RFC3394</span>, <time datetime="2002-09" class="refDate">September 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3394">https://www.rfc-editor.org/info/rfc3394</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3547">[RFC3547]</dt>
        <dd>
<span class="refAuthor">Baugher, M.</span><span class="refAuthor">, Weis, B.</span><span class="refAuthor">, Hardjono, T.</span><span class="refAuthor">, and H. Harney</span>, <span class="refTitle">"The Group Domain of Interpretation"</span>, <span class="seriesInfo">RFC 3547</span>, <span class="seriesInfo">DOI 10.17487/RFC3547</span>, <time datetime="2003-07" class="refDate">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3547">https://www.rfc-editor.org/info/rfc3547</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3711">[RFC3711]</dt>
        <dd>
<span class="refAuthor">Baugher, M.</span><span class="refAuthor">, McGrew, D.</span><span class="refAuthor">, Naslund, M.</span><span class="refAuthor">, Carrara, E.</span><span class="refAuthor">, and K. Norrman</span>, <span class="refTitle">"The Secure Real-time Transport Protocol (SRTP)"</span>, <span class="seriesInfo">RFC 3711</span>, <span class="seriesInfo">DOI 10.17487/RFC3711</span>, <time datetime="2004-03" class="refDate">March 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3711">https://www.rfc-editor.org/info/rfc3711</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3830">[RFC3830]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span><span class="refAuthor">, Carrara, E.</span><span class="refAuthor">, Lindholm, F.</span><span class="refAuthor">, Naslund, M.</span><span class="refAuthor">, and K. Norrman</span>, <span class="refTitle">"MIKEY: Multimedia Internet KEYing"</span>, <span class="seriesInfo">RFC 3830</span>, <span class="seriesInfo">DOI 10.17487/RFC3830</span>, <time datetime="2004-08" class="refDate">August 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3830">https://www.rfc-editor.org/info/rfc3830</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4987">[RFC4987]</dt>
        <dd>
<span class="refAuthor">Eddy, W.</span>, <span class="refTitle">"TCP SYN Flooding Attacks and Common Mitigations"</span>, <span class="seriesInfo">RFC 4987</span>, <span class="seriesInfo">DOI 10.17487/RFC4987</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4987">https://www.rfc-editor.org/info/rfc4987</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8216">[RFC8216]</dt>
        <dd>
<span class="refAuthor">Pantos, R., Ed.</span><span class="refAuthor"> and W. May</span>, <span class="refTitle">"HTTP Live Streaming"</span>, <span class="seriesInfo">RFC 8216</span>, <span class="seriesInfo">DOI 10.17487/RFC8216</span>, <time datetime="2017-08" class="refDate">August 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8216">https://www.rfc-editor.org/info/rfc8216</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8312">[RFC8312]</dt>
        <dd>
<span class="refAuthor">Rhee, I.</span><span class="refAuthor">, Xu, L.</span><span class="refAuthor">, Ha, S.</span><span class="refAuthor">, Zimmermann, A.</span><span class="refAuthor">, Eggert, L.</span><span class="refAuthor">, and R. Scheffenegger</span>, <span class="refTitle">"CUBIC for Fast Long-Distance Networks"</span>, <span class="seriesInfo">RFC 8312</span>, <span class="seriesInfo">DOI 10.17487/RFC8312</span>, <time datetime="2018-02" class="refDate">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8312">https://www.rfc-editor.org/info/rfc8312</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RTMP">[RTMP]</dt>
        <dd>
<span class="refTitle">"Real-Time Messaging Protocol"</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.adobe.com/devnet/rtmp.html">https://www.adobe.com/devnet/rtmp.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP800-38A">[SP800-38A]</dt>
        <dd>
<span class="refAuthor">Dworkin, M.</span>, <span class="refTitle">"Recommendation for Block Cipher Modes of Operation"</span>, <time datetime="2001-12" class="refDate">December 2001</time>. </dd>
<dd class="break"></dd>
<dt id="SRTSRC">[SRTSRC]</dt>
        <dd>
<span class="refTitle">"SRT fully functional reference implementation"</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://github.com/Haivision/srt">https://github.com/Haivision/srt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SRTTO">[SRTTO]</dt>
        <dd>
<span class="refAuthor">Dube, J.</span><span class="refAuthor"> and S. Matthews</span>, <span class="refTitle">"SRT Protocol Technical Overview"</span>, <time datetime="2019-12" class="refDate">December 2019</time>. </dd>
<dd class="break"></dd>
<dt id="VP9">[VP9]</dt>
      <dd>
<span class="refAuthor">WebM</span>, <span class="refTitle">"VP9 Video Codec"</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.webmproject.org/vp9">https://www.webmproject.org/vp9</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="packet-seq-list-coding">
<section id="section-appendix.a">
      <h2 id="name-packet-sequence-list-coding">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-packet-sequence-list-coding" class="section-name selfRef">Packet Sequence List coding</a>
      </h2>
<p id="section-appendix.a-1">For any single packet sequence number,
it uses the original sequence number in the field. The first bit 
must start with "0".<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<span id="name-single-sequence-numbers-cod"></span><div id="single-sequence-number">
<figure id="figure-18">
        <div class="artwork art-text alignLeft" id="section-appendix.a-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|                   Sequence Number                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-single-sequence-numbers-cod" class="selfRef">Single sequence numbers coding</a>
        </figcaption></figure>
</div>
<p id="section-appendix.a-3">For any consecutive packet sequence numbers that the difference between
the last and first is more than 1, only record the first (a) and the
the last (b) sequence numbers in the list field, and modify the
the first bit of a to "1".<a href="#section-appendix.a-3" class="pilcrow">¶</a></p>
<span id="name-list-of-sequence-numbers-co"></span><div id="list-sequence-numbers">
<figure id="figure-19">
        <div class="artwork art-text alignLeft" id="section-appendix.a-4.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|                   Sequence Number a (first)                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|                   Sequence Number b (last)                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-list-of-sequence-numbers-co" class="selfRef">List of sequence numbers coding</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-srt-access-control">
<section id="section-appendix.b">
      <h2 id="name-srt-access-control">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-srt-access-control" class="section-name selfRef">SRT Access Control</a>
      </h2>
<p id="section-appendix.b-1">One type of information that can be interchanged when a connection is being established in SRT
is the Stream ID, which can be used in a caller-listener connection layout.
This is a string of maximum 512 characters set on the caller side.
It can be retrieved at the listener side on the newly accepted connection.<a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
<p id="section-appendix.b-2">SRT listener can notify an upstream application about the connection attempt when a HS conclusion arrives,
exposing the contents of the Stream ID extension message.
Based on this information, the application can accept or reject the connection,
select the desired data stream, or set an appropriate passphrase for the connection.<a href="#section-appendix.b-2" class="pilcrow">¶</a></p>
<p id="section-appendix.b-3">The Stream ID value can be used as free-form, but there is a recommended convention so that
all SRT users speak the same language. The intent of the convention is to:<a href="#section-appendix.b-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.b-4.1">promote readability and consistency among free-form names,<a href="#section-appendix.b-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.b-4.2">interpret some typical data in the key-value style.<a href="#section-appendix.b-4.2" class="pilcrow">¶</a>
</li>
      </ul>
<div id="general-syntax">
<section id="section-b.1">
        <h2 id="name-general-syntax">
<a href="#section-b.1" class="section-number selfRef">B.1. </a><a href="#name-general-syntax" class="section-name selfRef">General Syntax</a>
        </h2>
<p id="section-b.1-1">This recommended syntax starts with the characters known as an executable specification in POSIX: #!.<a href="#section-b.1-1" class="pilcrow">¶</a></p>
<p id="section-b.1-2">The next two characters are:<a href="#section-b.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.1-3">
<pre>
: - this marks the YAML format, the only one currently used
The content format, which is either:
    : - the comma-separated keys with no nesting
    { - like above, but nesting is allowed and must end with }
</pre><a href="#section-b.1-3" class="pilcrow">¶</a>
</div>
<p id="section-b.1-4">(Nesting means that you can have multiple level brace-enclosed parts inside.)<a href="#section-b.1-4" class="pilcrow">¶</a></p>
<p id="section-b.1-5">The form of the key-value pair is:<a href="#section-b.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.1-6">
<pre>
key1=value1,key2=value2...
</pre><a href="#section-b.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="standard-keys">
<section id="section-b.2">
        <h2 id="name-standard-keys">
<a href="#section-b.2" class="section-number selfRef">B.2. </a><a href="#name-standard-keys" class="section-name selfRef">Standard Keys</a>
        </h2>
<p id="section-b.2-1">Beside the general syntax, there are several top-level keys treated as standard keys.
All single letter key definitions, including those not listed in this section, are reserved for future use.
Users can additionally use custom key definitions with user_* or companyname_* prefixes,
where user and companyname are to be replaced with an actual user or company name.<a href="#section-b.2-1" class="pilcrow">¶</a></p>
<p id="section-b.2-2">The existing key values must not be extended, and must not differ from those described in this section.<a href="#section-b.2-2" class="pilcrow">¶</a></p>
<p id="section-b.2-3">The following keys are standard:<a href="#section-b.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-b.2-4.1">u: User Name, or authorization name, that is expected to control which password should be used for the connection.
The application should interpret it to distinguish which user should be used by the listener party to set up the password.<a href="#section-b.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-b.2-4.2">r: Resource Name identifies the name of the resource and facilitates selection should the listener party be able to serve multiple resources.<a href="#section-b.2-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-b.2-4.3">h: Host Name identifies the hostname of the resource. For example, to request a stream with the URI somehost.com/videos/querry.php?vid=366
the hostname field should have somehost.com, and the resource name can have videos/querry.php?vid=366 or simply 366.
Note that this is still a key to be specified explicitly. Support tools that apply simplifications and URI extraction
are expected to insert only the host portion of the URI here.<a href="#section-b.2-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-b.2-4.4">s: Session ID is a temporary resource identifier negotiated with the server, used just for verification.
This is a one-shot identifier, invalidated after the first use. The expected usage is when details for the resource
and authorization are negotiated over a separate connection first, and then the session ID is used here alone.<a href="#section-b.2-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-b.2-4.5">
            <p id="section-b.2-4.5.1">t: Type specifies the purpose of the connection. Several standard types are defined, but users may extend the use:<a href="#section-b.2-4.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-b.2-4.5.2.1">stream (default, if not specified): for exchanging the user-specified payload for an application-defined purpose,<a href="#section-b.2-4.5.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-b.2-4.5.2.2">file: for transmitting a file, where r is the filename,<a href="#section-b.2-4.5.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-b.2-4.5.2.3">auth: for exchanging sensible data. The r value states its purpose. No specific possible values for that are known so far (FUTURE USE).<a href="#section-b.2-4.5.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-b.2-4.6">
            <p id="section-b.2-4.6.1">m: Mode expected for this connection:<a href="#section-b.2-4.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-b.2-4.6.2.1">request (default): the caller wants to receive the stream,<a href="#section-b.2-4.6.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-b.2-4.6.2.2">publish: the caller wants to send the stream data,<a href="#section-b.2-4.6.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-b.2-4.6.2.3">bidirectional: bidirectional data exchange is expected.<a href="#section-b.2-4.6.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-b.2-5">Note that "m" is not required in the case where Stream ID is not used to distinguish authorization or resources,
and the caller is expected to send the data. This is only for cases where the listener can handle various purposes of the connection
and is therefore required to know what the caller is attempting to do.<a href="#section-b.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="examples">
<section id="section-b.3">
        <h2 id="name-examples">
<a href="#section-b.3" class="section-number selfRef">B.3. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
        </h2>
<p id="section-b.3-1">The example content of the StreamID is:<a href="#section-b.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.3-2">
<pre>
#!::u=admin,r=bluesbrothers1_hi
</pre><a href="#section-b.3-2" class="pilcrow">¶</a>
</div>
<p id="section-b.3-3">It specifies the username and the resource name of the stream to be served to the caller.<a href="#section-b.3-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.3-4">
<pre>
#!::u=johnny,t=file,m=publish,r=results.csv
</pre><a href="#section-b.3-4" class="pilcrow">¶</a>
</div>
<p id="section-b.3-5">This specifies that the file is expected to be transmitted from the caller to the listener and its name is results.csv.<a href="#section-b.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Maxim Sharabayko</span></div>
<div dir="auto" class="left"><span class="org">Haivision Network Video, GmbH</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:maxsharabayko@haivision.com" class="email">maxsharabayko@haivision.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Maria Sharabayko</span></div>
<div dir="auto" class="left"><span class="org">Haivision Network Video, GmbH</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:msharabayko@haivision.com" class="email">msharabayko@haivision.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jean Dube</span></div>
<div dir="auto" class="left"><span class="org">Haivision</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jdube@haivision.com" class="email">jdube@haivision.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jeongseok Kim</span></div>
<div dir="auto" class="left"><span class="org">SK Telecom Co., Ltd.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jeongseok.kim@sk.com" class="email">jeongseok.kim@sk.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Joonwoong Kim</span></div>
<div dir="auto" class="left"><span class="org">SK Telecom Co., Ltd.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:joonwoong.kim@sk.com" class="email">joonwoong.kim@sk.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
